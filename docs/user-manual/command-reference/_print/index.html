<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.83.1" /><link rel="canonical" type="text/html" href="../../../../docs/user-manual/command-reference/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="../../../../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../../../../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../../../../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../../../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../../../../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../../../../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../../../../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../../../../favicons/android-192x192.png" sizes="192x192">

<title>Command reference | Dataset Management Framework</title>
<meta name="description" content=""><meta property="og:title" content="Command reference" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/user-manual/command-reference/" /><meta property="og:site_name" content="Dataset Management Framework" />

<meta itemprop="name" content="Command reference">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Command reference"/>
<meta name="twitter:description" content=""/>




<link rel="preload" href="../../../../scss/main.min.7739044bd284ace8b77f1ace79422fd408a2224eb69c6b8d48ef94dde2a179d5.css" as="style">
<link href="../../../../scss/main.min.7739044bd284ace8b77f1ace79422fd408a2224eb69c6b8d48ef94dde2a179d5.css" rel="stylesheet" integrity="">


<script
  src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>






<link rel="stylesheet" href="../../../../css/prism.css"/>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="../../../../docs">
    <span class="navbar-logo"></span><span class="font-weight-bold">Dataset Management Framework</span>
  </a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      
      
        <li class="nav-item mr-4 mb-2 mb-lg-0">
          
          
          
          
          
          
          <a class="nav-link" href="https://github.com/openvinotoolkit/datumaro"  ><i class='fab fa-github'></i><span>GitHub</span></a>
        </li>
      
        <li class="nav-item mr-4 mb-2 mb-lg-0" id="api">
          <a class="nav-link" href="../../../../api">API documentation</a>
        </li>
      
        <li class="nav-item dropdown mr-4 d-lg-block">
          

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  develop
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
  
    
      <a class="dropdown-item" href="../../../../docs/user-manual/command-reference/">develop</a>
  
</div>

        </li>
      
      
    </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="../../../../offline-search-index.e64feadb013a0ab709f05c531678edd0.json"
  data-offline-search-base-href="../../../../"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="../../../../docs/user-manual/command-reference/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Command reference</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-70c651cad336e515180a9b8eed13f292">Checkout</a></li>


    
  
    
    
	
<li>2: <a href="#pg-6c14c8898a52d18d0040b216c7faf6a6">Commit</a></li>


    
  
    
    
	
<li>3: <a href="#pg-a343cd09a10c892413f1c9e19af35d61">Convert datasets</a></li>


    
  
    
    
	
<li>4: <a href="#pg-4cdc48f6e2e41c6dd35af61e5748ac77">Create project</a></li>


    
  
    
    
	
<li>5: <a href="#pg-93c9f45615f89ceac9312b63ffcf8b65">Describe downloadable datasets</a></li>


    
  
    
    
	
<li>6: <a href="#pg-3edc3b754a785c8818028837f5d7e754">Detect dataset format</a></li>


    
  
    
    
	
<li>7: <a href="#pg-cf615af9fbd176c3c8963db17cdccfec">Compare datasets</a></li>


    
  
    
    
	
<li>8: <a href="#pg-77963f24abb4e1f7e8cb372f0cf73ad7">Download datasets</a></li>


    
  
    
    
	
<li>9: <a href="#pg-5a841ebe671810e701d94cfd348da645">Run model inference explanation (explain)</a></li>


    
  
    
    
	
<li>10: <a href="#pg-bf2416754f5a95167671095e620607d7">Export Datasets</a></li>


    
  
    
    
	
<li>11: <a href="#pg-fb79096cff317cd3a11940138d12144a">Filter datasets</a></li>


    
  
    
    
	
<li>12: <a href="#pg-0c1db009ad311413c7036db1bd602bf0">Generate Datasets</a></li>


    
  
    
    
	
<li>13: <a href="#pg-08529e9683af8c1a879605b62306ea7a">Print dataset info</a></li>


    
  
    
    
	
<li>14: <a href="#pg-209bf2b1793403ac2d9c18c87a7dab54">Log</a></li>


    
  
    
    
	
<li>15: <a href="#pg-6758bfd1eb71e4d0b6c4bf4aca1806f1">Merge Datasets</a></li>


    
  
    
    
	
<li>16: <a href="#pg-db2ab356420634e305b5ea0550f9b9c3">Models</a></li>


    
  
    
    
	
<li>17: <a href="#pg-160c03d29dec976c331bb969c9551cf4">Patch Datasets</a></li>


    
  
    
    
	
<li>18: <a href="#pg-49c04c4e75f0995ee1c9c4c121d042c7">Projects</a></li>


    
  
    
    
	
<li>19: <a href="#pg-dc182af461d71cbd7217b8679bde29bc">Sources</a></li>


    
  
    
    
	
<li>20: <a href="#pg-645d2da4c36696ec093ba5e3ce99c77c">Get Project Statistics</a></li>


    
  
    
    
	
<li>21: <a href="#pg-a818e6c810d9d8ef27c2b0f440145895">Status</a></li>


    
  
    
    
	
<li>22: <a href="#pg-86897105a5f038a99bfe0935866c69ce">Transform Dataset</a></li>


    
  
    
    
	
<li>23: <a href="#pg-10150a1a6326aa9e8f2020442e6da77d">Utilities</a></li>


    
  
    
    
	
<li>24: <a href="#pg-a6fd93528e84d29a5a0d58dbccb92724">Validate Dataset</a></li>


    
  

    </ul>


<div class="content">
      <div class="text-center large-scheme-two">
<pre><code class="language-mermaid" data-lang="mermaid">%%{init { 'theme':'neutral' }}%%
flowchart LR
  d((&quot;#0009; datum #0009;&quot;)):::mainclass
  m(model):::nofillclass
  p(project):::nofillclass
  s(source):::nofillclass

  d===m
    m===m_add[add]:::hideclass
    m===m_info[info]:::hideclass
    m===m_remove[remove]:::hideclass
    m===m_run[run]:::hideclass
  d===p
    p===p_info[info]:::hideclass
    p===p_migrate[migrate]:::hideclass
  d===s
    s===s_add[add]:::hideclass
    s===s_info[info]:::hideclass
    s===s_remove[remove]:::hideclass
  d====_add[add]:::filloneclass
  d====_create[create]:::filloneclass
  d====_describe_downloads[describe-downloads]:::filloneclass
  d====_detect_format[detect-format]:::filloneclass
  d====_download[download]:::filloneclass
  d====_export[export]:::filloneclass
  d====_import[import]:::filloneclass
  d====_info[info]:::filloneclass
  d====_remove[remove]:::filloneclass
  d====_generate[generate]:::filloneclass
  d====_filter[filter]:::filltwoclass
  d====_transform[transform]:::filltwoclass
  d====_diff[diff]:::fillthreeclass
  d====_explain[explain]:::fillthreeclass
  d====_merge[merge]:::fillthreeclass
  d====_patch[patch]:::fillthreeclass
  d====_stats[stats]:::fillthreeclass
  d====_validate[validate]:::fillthreeclass
  d====_checkout[checkout]:::fillfourclass
  d====_commit[commit]:::fillfourclass
  d====_log[log]:::fillfourclass
  d====_status[status]:::fillfourclass

  classDef nofillclass fill-opacity:0;
  classDef hideclass fill-opacity:0,stroke-opacity:0;
  classDef filloneclass fill:#CCCCFF,stroke-opacity:0;
  classDef filltwoclass fill:#FFFF99,stroke-opacity:0;
  classDef fillthreeclass fill:#CCFFFF,stroke-opacity:0;
  classDef fillfourclass fill:#CCFFCC,stroke-opacity:0;
</code></pre></div>
<p>The command line is split into the separate <em>commands</em> and command <em>contexts</em>.
Contexts group multiple commands related to a specific topic, e.g.
project operations, data source operations etc. Almost all the commands
operate on projects, so the <code>project</code> context and commands without a context
are mostly the same. By default, commands look for a project in the current
directory. If the project you&rsquo;re working on is located somewhere else, you
can pass the <code>-p/--project &lt;path&gt;</code> argument to the command.</p>
<blockquote>
<p><strong>Note</strong>: command behavior is subject to change, so this text might be
outdated,
<strong>always check the <code>--help</code> output of the specific command</strong></p>
</blockquote>
<!-- markdownlint-disable-line MD028 -->
<blockquote>
<p><strong>Note</strong>: command parameters must be passed prior to the positional arguments.</p>
</blockquote>
<p>Datumaro functionality is available with the <code>datum</code> command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--version<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--loglevel LOGLEVEL<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>command<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span><span style="color:#204a87">command</span> args<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>--loglevel</code> (string) - Logging level, one of
<code>debug</code>, <code>info</code>, <code>warning</code>, <code>error</code>, <code>critical</code> (default: <code>info</code>)</li>
<li><code>--version</code> - Print the version number and exit.</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-70c651cad336e515180a9b8eed13f292">1 - Checkout</h1>
    
	<p>This command allows to restore a specific project revision in the project
tree or to restore separate revisions of sources. A revision can be a commit
hash, branch, tag, or any <a href="https://git-scm.com/book/en/v2/Git-Tools-Revision-Selection">relative reference in the Git format</a>.</p>
<p>This command has multiple forms:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">1<span style="color:#ce5c00;font-weight:bold">)</span> datum checkout &lt;revision&gt;
2<span style="color:#ce5c00;font-weight:bold">)</span> datum checkout <span style="color:#ce5c00;font-weight:bold">[</span>--<span style="color:#ce5c00;font-weight:bold">]</span> &lt;source1&gt; ...
3<span style="color:#ce5c00;font-weight:bold">)</span> datum checkout &lt;revision&gt; <span style="color:#ce5c00;font-weight:bold">[</span>--<span style="color:#ce5c00;font-weight:bold">]</span> &lt;source1&gt; &lt;source2&gt; ...
</code></pre></div><p>1 - Restores a revision and all the corresponding sources in the
working directory. If there are conflicts between modified files in the
working directory and the target revision, an error is raised, unless
<code>--force</code> is used.</p>
<p>2, 3 - Restores only selected sources from the specified revision.
The current revision is used, when not set.</p>
<p>&ldquo;&ndash;&rdquo; can be used to separate source names and revisions:</p>
<ul>
<li><code>datum checkout name</code> - will look for revision &ldquo;name&rdquo;</li>
<li><code>datum checkout -- name</code> - will look for source &ldquo;name&rdquo; in the current
revision</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum checkout <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-f<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>rev<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>sources <span style="color:#ce5c00;font-weight:bold">[</span>sources ...<span style="color:#ce5c00;font-weight:bold">]]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>--force</code> - Allows to overwrite unsaved changes in case of conflicts</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<ul>
<li>
<p>Restore the previous revision:
<code>datum checkout HEAD~1</code>
<br></p>
</li>
<li>
<p>Restore the saved version of a source in the working tree
<code>datum checkout -- source-1</code>
<br></p>
</li>
<li>
<p>Restore a previous version of a source
<code>datum checkout 33fbfbe my-source</code>
<br></p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6c14c8898a52d18d0040b216c7faf6a6">2 - Commit</h1>
    
	<p>This command allows to fix the current state of a project and
create a new revision from the working tree.</p>
<p>By default, this command checks sources in the working tree for
changes. If there are unknown changes found, an error will be raised,
unless <code>--allow-foreign</code> is used. If such changes are committed,
the source will only be available for reproduction from the project
cache, because Datumaro will not know how to repeat them.</p>
<p>The command will add the sources into the project cache. If you only
need to record revision metadata, you can use the <code>--no-cache</code> parameter.
This can be useful if you want to save disk space and/or have a backup copy
of datasets used in the project.</p>
<p>If there are no changes found, the command will stop. To allow empty
commits, use <code>--allow-empty</code>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum commit <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -m MESSAGE <span style="color:#ce5c00;font-weight:bold">[</span>--allow-empty<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--allow-foreign<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--no-cache<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>--allow-empty</code> - Allow commits with no changes</li>
<li><code>--allow-foreign</code> - Allow commits with changes made not by Datumaro</li>
<li><code>--no-cache</code> - Don&rsquo;t put committed datasets into cache, save only metadata</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f coco &lt;path/to/coco/&gt;
datum commit -m <span style="color:#4e9a06">&#34;Added COCO&#34;</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a343cd09a10c892413f1c9e19af35d61">3 - Convert datasets</h1>
    
	<p>This command allows to convert a dataset from one format to another.
The command is a usability alias for <a href="../create"><code>create</code></a>,
<a href="../sources/#sources-add"><code>add</code></a> and <a href="../export"><code>export</code></a> and just provides
a simpler way to obtain the same results in simple cases. A list of supported
formats can be found in the <code>--help</code> output of this command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-i SOURCE<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-if INPUT_FORMAT<span style="color:#ce5c00;font-weight:bold">]</span> -f OUTPUT_FORMAT
  <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e FILTER<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--filter-mode FILTER_MODE<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_EXPORT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-i, --input-path</code> (string) - Input dataset path. The current directory is
used by default.</li>
<li><code>-if, --input-format</code> (string) - Input dataset format. Will try to detect,
if not specified.</li>
<li><code>-f, --output-format</code> (string) - Output format</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a subdirectory
in the current directory is used.</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty.</li>
<li><code>-e, --filter</code> (string) - XML XPath filter expression for dataset items</li>
<li><code>--filter-mode</code> (string) - The filtering mode. Default is the <code>i</code> mode.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra export args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: convert a VOC-like dataset to a COCO-like one:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum convert --input-format voc --input-path &lt;path/to/voc/&gt; <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              --output-format coco <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>              -- --save-images
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4cdc48f6e2e41c6dd35af61e5748ac77">4 - Create project</h1>
    
	<p>The command creates an empty project. A project is required for the most of
Datumaro functionality.</p>
<p>By default, the project is created in the current directory. To specify
another output directory, pass the <code>-o/--output-dir</code> parameter. If output
already directory contains a Datumaro project, an error is raised, unless
<code>--overwrite</code> is used.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-o, --output-dir</code> (string) - Allows to specify an output directory.
The current directory is used by default.</li>
<li><code>--overwrite</code> - Allows to overwrite existing project files in the output
directory. Any other files are not touched.</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<p>Example: create an empty project in the <code>my_dataset</code> directory</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o my_dataset/
</code></pre></div><p>Example: create a new empty project in the current directory, remove the
existing one</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
...
datum create --overwrite
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-93c9f45615f89ceac9312b63ffcf8b65">5 - Describe downloadable datasets</h1>
    
	<p>This command reports reports various information about datasets that can be
downloaded with the <code>download</code> command. The information is reported either as
human-readable text (the default) or as a JSON object. The format can be selected
with the <code>--report-format</code> option.</p>
<p>When the JSON output format is selected, the output document has the following schema:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;&lt;dataset name&gt;&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;default_output_format&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;Datumaro format name&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;human-readable description&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;download_size&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">&lt;total</span> <span style="color:#a40000">size</span> <span style="color:#a40000">of</span> <span style="color:#a40000">the</span> <span style="color:#a40000">downloaded</span> <span style="color:#a40000">files</span> <span style="color:#a40000">in</span> <span style="color:#a40000">bytes&gt;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;home_url&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;URL of a web page describing the dataset&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;human_name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;human-readable dataset name&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;num_classes&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">&lt;number</span> <span style="color:#a40000">of</span> <span style="color:#a40000">classes</span> <span style="color:#a40000">in</span> <span style="color:#a40000">the</span> <span style="color:#a40000">dataset&gt;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;subsets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;&lt;subset name&gt;&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">&#34;num_items&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">&lt;number</span> <span style="color:#a40000">of</span> <span style="color:#a40000">items</span> <span style="color:#a40000">in</span> <span style="color:#a40000">the</span> <span style="color:#a40000">subset&gt;</span>
            <span style="color:#000;font-weight:bold">},</span>
            <span style="color:#a40000">...</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;version number&gt;&#34;</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#a40000">...</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><code>home_url</code> may be <code>null</code> if there is no suitable web page for the dataset.</p>
<p><code>num_classes</code> may be <code>null</code> if the dataset does not involve classification.</p>
<p><code>version</code> currently contains the version number supplied by TFDS.
In future versions of Datumaro, datasets might come from other sources;
the way version numbers will be set for those is to be determined.</p>
<p>New object members may be added in future versions of Datumaro.</p>
<p>Usage:</p>
<pre><code>datum describe-downloads [-h] [--report-format {text,json}]
                         [--report-file REPORT_FILE]
</code></pre><p>Parameters:</p>
<ul>
<li><code>-h</code>, <code>--help</code> - Print the help message and exit.</li>
<li><code>--report-format</code> (<code>text</code> or <code>json</code>) - Format in which to report the information.
By default, <code>text</code> is used.</li>
<li><code>--report-file</code> (string) - File to which to write the report. By default,
the report is written to the standard output stream.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3edc3b754a785c8818028837f5d7e754">6 - Detect dataset format</h1>
    
	<p>This command attempts to detect the format of a dataset in a directory.
Currently, only local directories are supported.</p>
<p>The detection result may be one of:</p>
<ul>
<li>a single format being detected;</li>
<li>no formats being detected (if the dataset doesn&rsquo;t match any known format);</li>
<li>multiple formats being detected (if the dataset is ambiguous).</li>
</ul>
<p>The command outputs this result in a human-readable form and
optionally as a machine-readable JSON report (see <code>--json-report</code>).</p>
<p>The format of the machine-readable report is as follows:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;detected_formats&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#4e9a06">&#34;detected-format-name-1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;detected-format-name-2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#a40000">...</span>
    <span style="color:#000;font-weight:bold">],</span>
    <span style="color:#204a87;font-weight:bold">&#34;rejected_formats&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;rejected-format-name-1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;reason&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">&lt;reason-code&gt;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;line 1\nline 2\n...\nline N&#34;</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;rejected-format-name-2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#a40000">...</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#a40000">...</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>The <code>&lt;reason-code&gt;</code> can be one of:</p>
<ul>
<li>
<p><code>&quot;detection_unsupported&quot;</code>: the corresponding format does not support
detection.</p>
</li>
<li>
<p><code>&quot;insufficient_confidence&quot;</code>: the dataset matched the corresponding format,
but it matched at least one other format better.</p>
</li>
<li>
<p><code>&quot;unmet_requirements&quot;</code>: the dataset didn&rsquo;t meet at least one requirement
of the corresponding format.</p>
</li>
</ul>
<p>Other reason codes may be defined in the future.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum detect-format <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--show-rejections<span style="color:#ce5c00;font-weight:bold">]</span>
                    <span style="color:#ce5c00;font-weight:bold">[</span>--json-report JSON_REPORT<span style="color:#ce5c00;font-weight:bold">]</span>
                    url
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;url&gt;</code> - Path to the dataset to analyse.</li>
<li><code>-h</code>, <code>--help</code> - Print the help message and exit.</li>
<li><code>-p, --project</code> (string) - Directory of the project to use as the context
(default: current directory). The project might contain local plugins with
custom formats, which will be used for detection.</li>
<li><code>--show-rejections</code> - Describe why each supported format that wasn&rsquo;t
detected was rejected. This only affects the human-readable output; the
machine-readable report always includes rejection information.</li>
<li><code>--json-report</code> (string) - Path to which to save a JSON report describing
detected and rejected formats. By default, no report is saved.</li>
</ul>
<p>Example: detect the format of a dataset in a given directory,
showing rejection information:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum detect-format --show-rejections path/to/dataset
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cf615af9fbd176c3c8963db17cdccfec">7 - Compare datasets</h1>
    
	<p>The command compares two datasets and saves the results in the
specified directory. The current project is considered to be
&ldquo;ground truth&rdquo;.</p>
<p>Datasets can be compared using different methods:</p>
<ul>
<li><code>equality</code> - Annotations are compared to be equal</li>
<li><code>distance</code> - A distance metric is used</li>
</ul>
<p>This command has multiple forms:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">1<span style="color:#ce5c00;font-weight:bold">)</span> datum diff &lt;revpath&gt;
2<span style="color:#ce5c00;font-weight:bold">)</span> datum diff &lt;revpath&gt; &lt;revpath&gt;
</code></pre></div><p>1 - Compares the current project&rsquo;s main target (<code>project</code>)
in the working tree with the specified dataset.</p>
<p>2 - Compares two specified datasets.</p>
<p>&lt;revpath&gt; - <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">a dataset path or a revision path</a>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum diff <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-m METHOD<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--iou-thresh IOU_THRESH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-f FORMAT<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-iia IGNORE_ITEM_ATTR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-ia IGNORE_ATTR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-if IGNORE_FIELD<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--match-images<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--all<span style="color:#ce5c00;font-weight:bold">]</span>
  first_target <span style="color:#ce5c00;font-weight:bold">[</span>second_target<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li>
<p><code>&lt;target&gt;</code> (string) - Target <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpaths</a></p>
</li>
<li>
<p><code>-m, --method</code> (string) - Comparison method.</p>
</li>
<li>
<p><code>-o, --output-dir</code> (string) - Output directory. By default, a new directory
is created in the current directory.</p>
</li>
<li>
<p><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</p>
</li>
<li>
<p><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</p>
</li>
<li>
<p><code>-h, --help</code> - Print the help message and exit.</p>
</li>
<li>
<p>Distance comparison options:</p>
<ul>
<li><code>--iou-thresh</code> (number) - The IoU threshold for spatial annotations
(default is 0.5).</li>
<li><code>-f, --format</code> (string) - Output format, one of <code>simple</code>
(text files and images) and <code>tensorboard</code> (a TB log directory)</li>
</ul>
</li>
<li>
<p>Equality comparison options:</p>
<ul>
<li><code>-iia, --ignore-item-attr</code> (string) - Ignore an item attribute (repeatable)</li>
<li><code>-ia, --ignore-attr</code> (string) - Ignore an annotation attribute (repeatable)</li>
<li><code>-if, --ignore-field</code> (string) - Ignore an annotation field (repeatable)
Default is <code>id</code> and <code>group</code></li>
<li><code>--match-images</code> - Match dataset items by image pixels instead of ids</li>
<li><code>--all</code> - Include matches in the output. By default, only differences are
printed.</li>
</ul>
</li>
</ul>
<!-- markdownlint-disable-line MD028 -->Examples:
<ul>
<li>
<p>Compare two projects by distance, match boxes if IoU &gt; 0.7,
save results to TensorBoard:
<code>datum diff other/project -o diff/ -f tensorboard --iou-thresh 0.7</code></p>
</li>
<li>
<p>Compare two projects for equality, exclude annotation groups
and the <code>is_crowd</code> attribute from comparison:
<code>datum diff other/project/ -if group -ia is_crowd</code></p>
</li>
<li>
<p>Compare two datasets, specify formats:
<code>datum diff path/to/dataset1:voc path/to/dataset2:coco</code></p>
</li>
<li>
<p>Compare the current working tree and a dataset:
<code>datum diff path/to/dataset2:coco</code></p>
</li>
<li>
<p>Compare a source from a previous revision and a dataset:
<code>datum diff HEAD~2:source-2 path/to/dataset2:yolo</code></p>
</li>
<li>
<p>Compare a dataset with model inference</p>
</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import &lt;...&gt;
datum model add mymodel &lt;...&gt;
datum transform &lt;...&gt; -o inference
datum diff inference -o diff
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-77963f24abb4e1f7e8cb372f0cf73ad7">8 - Download datasets</h1>
    
	<p>This command downloads a publicly available dataset and saves it to a local
directory.
In terms of syntax, this command is similar to <a href="../convert"><code>convert</code></a>,
but instead of taking a local directory as the source, it takes a dataset ID.
A list of supported datasets and output formats can be found in the <code>--help</code>
output of this command.</p>
<p>Currently, the only source of datasets is the TensorFlow Datasets library.
Therefore, to use this command you must install TensorFlow &amp; TFDS, which you can
do as follows:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pip install datumaro<span style="color:#ce5c00;font-weight:bold">[</span>tf,tfds<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>To use a proxy for downloading, configure it with the conventional
<a href="https://everything.curl.dev/usingcurl/proxies/env">curl environment variables</a>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum download <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -i DATASET_ID <span style="color:#ce5c00;font-weight:bold">[</span>-f OUTPUT_FORMAT<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
               <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_EXPORT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-h</code>, <code>--help</code> - Print the help message and exit.</li>
<li><code>-i</code>, <code>--dataset-id</code> (string) - ID of the dataset to download.</li>
<li><code>-f</code>, <code>--output-format</code> (string) - Output format. By default, the format
of the original dataset is used.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a subdirectory
in the current directory is used.</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty.</li>
<li><code>--subset</code> (string) - Which subset of the dataset to save. By default, all
subsets are saved. Note that due to limitations of TFDS, all subsets are
downloaded even if this option is specified.</li>
<li><code>-- &lt;extra export args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: download the MNIST dataset, saving it in the ImageNet text format:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum download -i tfds:mnist -f imagenet_txt -- --save-images
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5a841ebe671810e701d94cfd348da645">9 - Run model inference explanation (explain)</h1>
    
	<p>Runs an explainable AI algorithm for a model.</p>
<p>This tool is supposed to help an AI developer to debug a model and a dataset.
Basically, it executes model inference and tries to find relation between
inputs and outputs of the trained model, i.e. determine decision boundaries
and belief intervals for the classifier.</p>
<p>Currently, the only available algorithm is RISE (<a href="https://arxiv.org/pdf/1806.07421.pdf">article</a>),
which runs model a single time and then re-runs a model multiple times on
each image to produce a heatmap of activations for each output of the
first inference. Each time a part of the input image is masked. As a result,
we obtain a number heatmaps, which show, how specific image pixels affected
the inference result. This algorithm doesn&rsquo;t require any special information
about the model, but it requires the model to return all the outputs and
confidences. The original algorithm supports only classification scenario,
but Datumaro extends it for detection models.</p>
<p>The following use cases available:</p>
<ul>
<li>RISE for classification</li>
<li>RISE for object detection</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum explain <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -m MODEL <span style="color:#ce5c00;font-weight:bold">[</span>-o SAVE_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">{</span>rise<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">[</span>RISE_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li>
<p><code>&lt;target&gt;</code> (string) - Target
<a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.By default,
uses the whole current project. An image path can be specified instead.
&lt;image path&gt; - a path to the file.
&lt;revpath&gt; - <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">a dataset path or a revision path</a>.</p>
</li>
<li>
<p><code>&lt;method&gt;</code> (string) - The algorithm to use. Currently, only <code>rise</code>
is supported.</p>
</li>
<li>
<p><code>-m, --model</code> (string) - The model to use for inference</p>
</li>
<li>
<p><code>-o, --output-dir</code> (string) - Directory to save results to
(default: display only)</p>
</li>
<li>
<p><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</p>
</li>
<li>
<p><code>-h, --help</code> - Print the help message and exit.</p>
</li>
<li>
<p>RISE options:</p>
<ul>
<li><code>-s, --max-samples</code> (number) - Number of algorithm model runs per image
(default: mask size ^ 2).</li>
<li><code>--mw, --mask-width</code> (number) - Mask width in pixels (default: 7)</li>
<li><code>--mh, --mask-height</code> (number) - Mask height in pixels (default: 7)</li>
<li><code>--prob</code> (number) - Mask pixel inclusion probability, controls
mask density (default: 0.5)</li>
<li><code>--iou, --iou-thresh</code> (number) - IoU match threshold for detections
(default: 0.9)</li>
<li><code>--nms, --nms-iou-thresh</code> (number) - IoU match threshold for detections
for non-maxima suppression (default: no NMS)</li>
<li><code>--conf, --det-conf-thresh</code> (number) - Confidence threshold for
detections (default: include all)</li>
<li><code>-b, --batch-size</code> (number) - Batch size for inference (default: 1)</li>
<li><code>--display</code> - Visualize results during computations</li>
</ul>
</li>
</ul>
<p>Examples:</p>
<ul>
<li>
<p>Run RISE on an image, display results:
<code>datum explain path/to/image.jpg -m mymodel rise --max-samples 50</code></p>
</li>
<li>
<p>Run RISE on a source revision:
<code>datum explain HEAD~1:source-1 -m model rise</code></p>
</li>
<li>
<p>Run inference explanation on a single image with online visualization</p>
</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create &lt;...&gt;
datum model add mymodel &lt;...&gt;
datum explain -t image.png -m mymodel <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>    rise --max-samples <span style="color:#0000cf;font-weight:bold">1000</span> --display
</code></pre></div><blockquote>
<p>Note: this algorithm requires the model to return
<em>all</em> (or a <em>reasonable</em> amount) the outputs and confidences unfiltered,
i.e. all the <code>Label</code> annotations for classification models and
all the <code>Bbox</code>es for detection models.
You can find examples of the expected model outputs in <a href="https://github.com/openvinotoolkit/datumaro/tree/develop/tests/test_RISE.py"><code>tests/test_RISE.py</code></a></p>
</blockquote>
<p>For OpenVINO models the output processing script would look like this:</p>
<p>Classification scenario:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">datumaro.util.annotation_util</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">softmax</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">process_outputs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#8f5902;font-style:italic"># inputs = model input, array or images, shape = (N, C, H, W)</span>
    <span style="color:#8f5902;font-style:italic"># outputs = model output, logits, shape = (N, n_classes)</span>
    <span style="color:#8f5902;font-style:italic"># results = conversion result, [ [ Annotation, ... ], ... ]</span>
    <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">output</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#000">confs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">softmax</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">output</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">])</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">conf</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">enumerate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">confs</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#000">results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Label</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">)),</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87">float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">conf</span><span style="color:#000;font-weight:bold">)})</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">results</span>
</code></pre></div><p>Object Detection scenario:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#8f5902;font-style:italic"># return a significant number of output boxes to make multiple runs</span>
<span style="color:#8f5902;font-style:italic"># statistically correct and meaningful</span>
<span style="color:#000">max_det</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1000</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">process_outputs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#8f5902;font-style:italic"># inputs = model input, array or images, shape = (N, C, H, W)</span>
    <span style="color:#8f5902;font-style:italic"># outputs = model output, shape = (N, 1, K, 7)</span>
    <span style="color:#8f5902;font-style:italic"># results = conversion result, [ [ Annotation, ... ], ... ]</span>
    <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#204a87">input</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">output</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">zip</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input_width</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">input</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">shape</span><span style="color:#000;font-weight:bold">[:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000">detections</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">output</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000">image_results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">det</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">detections</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_width</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">w</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_width</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">input_width</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">h</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_height</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">image_results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">w</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">h</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">conf</span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">))</span>

            <span style="color:#000">results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image_results</span><span style="color:#000;font-weight:bold">[:</span><span style="color:#000">max_det</span><span style="color:#000;font-weight:bold">])</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">results</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bf2416754f5a95167671095e620607d7">10 - Export Datasets</h1>
    
	<p>This command exports a project or a source as a dataset in some format.</p>
<p>Check <a href="../../../../docs/user-manual/supported_formats">supported formats</a> for more info
about format specifications, supported options and other details.
The list of formats can be extended by custom plugins, check
<a href="../../../../docs/user-manual/extending">extending tips</a> for information on this topic.</p>
<p>Available formats are listed in the command help output.</p>
<p>Dataset format writers support additional export options. To pass
such options, use the <code>--</code> separator after the main command arguments.
The usage information can be printed with <code>datum import -f &lt;format&gt; -- --help</code>.</p>
<p>Common export options:</p>
<ul>
<li>Most formats (where applicable) support the <code>--save-images</code> option, which
allows to export dataset images along with annotations. The option is
disabled be default.</li>
<li>If <code>--save-images</code> is used, the <code>image-ext</code> option can be passed to
specify the output image file extension (<code>.jpg</code>, <code>.png</code> etc.). By default,
tries to Datumaro keep the original image extension. This option
allows to convert all the images from one format into another.</li>
</ul>
<p>This command allows to use the <code>-f/--filter</code> parameter to select dataset
elements needed for exporting. Read the <a href="../../../../docs/user-manual/command-reference/filter/"><code>filter</code></a>
command description for more info about this functionality.</p>
<p>The command can only be applied to a project build target, a stage
or the combined <code>project</code> target, in which case all the targets will
be affected.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e FILTER<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--filter-mode FILTER_MODE<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> -f FORMAT <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_FORMAT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - A project build target to be exported.
By default, all project targets are affected.</li>
<li><code>-f, --format</code> (string) - Output format.</li>
<li><code>-e, --filter</code> (string) - XML XPath filter expression for dataset items</li>
<li><code>--filter-mode</code> (string) - The filtering mode. Default is the <code>i</code> mode.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a subdirectory
in the current directory is used.</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra format args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: save a project as a VOC-like dataset, include images, convert
images to <code>PNG</code> from other formats.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum <span style="color:#204a87">export</span> <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -p test_project <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -o test_project-export <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -f voc <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -- --save-images --image-ext<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;.png&#39;</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fb79096cff317cd3a11940138d12144a">11 - Filter datasets</h1>
    
	<p>This command allows to extract a sub-dataset from a dataset. The new dataset
includes only items satisfying some condition. The XML <a href="https://devhints.io/xpath">XPath</a>
is used as a query format.</p>
<p>The command can be applied to a dataset or a project build target,
a stage or the combined <code>project</code> target, in which case all the project
targets will be affected. A build tree stage will be recorded
if <code>--stage</code> is enabled, and the resulting dataset(-s) will be
saved if <code>--apply</code> is enabled.</p>
<p>By default, datasets are updated in-place. The <code>-o/--output-dir</code>
option can be used to specify another output directory. When
updating in-place, use the <code>--overwrite</code> parameter (in-place
updates fail by default to prevent data loss), unless a project
target is modified.</p>
<p>The current project (<code>-p/--project</code>) is also used as a context for
plugins, so it can be useful for dataset paths having custom formats.
When not specified, the current project&rsquo;s working tree is used.</p>
<p>There are several filtering modes available (the <code>-m/--mode</code> parameter).
Supported modes:</p>
<ul>
<li><code>i</code>, <code>items</code></li>
<li><code>a</code>, <code>annotations</code></li>
<li><code>i+a</code>, <code>a+i</code>, <code>items+annotations</code>, <code>annotations+items</code></li>
</ul>
<p>When filtering annotations, use the <code>items+annotations</code>
mode to point that annotation-less dataset items should be
removed, otherwise they will be kept in the resulting dataset.
To select an annotation, write an XPath that returns <code>annotation</code>
elements (see examples).</p>
<p>Item representations can be printed with the <code>--dry-run</code> parameter:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#204a87;font-weight:bold">&lt;item&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>290768<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;subset&gt;</span>minival2014<span style="color:#204a87;font-weight:bold">&lt;/subset&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;image&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;width&gt;</span>612<span style="color:#204a87;font-weight:bold">&lt;/width&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;height&gt;</span>612<span style="color:#204a87;font-weight:bold">&lt;/height&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;depth&gt;</span>3<span style="color:#204a87;font-weight:bold">&lt;/depth&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/image&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;annotation&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>80154<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;type&gt;</span>bbox<span style="color:#204a87;font-weight:bold">&lt;/type&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;label_id&gt;</span>39<span style="color:#204a87;font-weight:bold">&lt;/label_id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;x&gt;</span>264.59<span style="color:#204a87;font-weight:bold">&lt;/x&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;y&gt;</span>150.25<span style="color:#204a87;font-weight:bold">&lt;/y&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;w&gt;</span>11.19<span style="color:#204a87;font-weight:bold">&lt;/w&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;h&gt;</span>42.31<span style="color:#204a87;font-weight:bold">&lt;/h&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;area&gt;</span>473.87<span style="color:#204a87;font-weight:bold">&lt;/area&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/annotation&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;annotation&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;id&gt;</span>669839<span style="color:#204a87;font-weight:bold">&lt;/id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;type&gt;</span>bbox<span style="color:#204a87;font-weight:bold">&lt;/type&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;label_id&gt;</span>41<span style="color:#204a87;font-weight:bold">&lt;/label_id&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;x&gt;</span>163.58<span style="color:#204a87;font-weight:bold">&lt;/x&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;y&gt;</span>191.75<span style="color:#204a87;font-weight:bold">&lt;/y&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;w&gt;</span>76.98<span style="color:#204a87;font-weight:bold">&lt;/w&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;h&gt;</span>73.63<span style="color:#204a87;font-weight:bold">&lt;/h&gt;</span>
    <span style="color:#204a87;font-weight:bold">&lt;area&gt;</span>5668.77<span style="color:#204a87;font-weight:bold">&lt;/area&gt;</span>
  <span style="color:#204a87;font-weight:bold">&lt;/annotation&gt;</span>
  ...
<span style="color:#204a87;font-weight:bold">&lt;/item&gt;</span>
</code></pre></div><p>The command can only be applied to a project build target, a stage or the
combined <code>project</code> target, in which case all the targets will be affected.
A build tree stage will be added if <code>--stage</code> is enabled, and the resulting
dataset(-s) will be saved if <code>--apply</code> is enabled.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum filter <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e FILTER<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-m MODE<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--dry-run<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--stage STAGE<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--apply APPLY<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target
<a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.
By default, filters all targets of the current project.</li>
<li><code>-e, --filter</code> (string) - XML XPath filter expression for dataset items</li>
<li><code>-m, --mode</code> (string) - The filtering mode. Default is the <code>i</code> mode.</li>
<li><code>--dry-run</code> - Print XML representations of the filtered dataset and exit.</li>
<li><code>--stage</code> (bool) - Include this action as a project build step.
If true, this operation will be saved in the project
build tree, allowing to reproduce the resulting dataset later.
Applicable only to main project targets (i.e. data sources
and the <code>project</code> target, but not intermediate stages). Enabled by default.</li>
<li><code>--apply</code> (bool) - Run this command immediately. If disabled, only the
build tree stage will be written. Enabled by default.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. Can be omitted for
main project targets (i.e. data sources and the <code>project</code> target, but not
intermediate stages) and dataset targets. If not specified, the results
will be saved inplace.</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example: extract a dataset with images with <code>width</code> &lt; <code>height</code></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum filter <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -p test_project <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -e <span style="color:#4e9a06">&#39;/item[image/width &lt; image/height]&#39;</span>
</code></pre></div><p>Example: extract a dataset with images of the <code>train</code> subset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum filter <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -p test_project <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -e <span style="color:#4e9a06">&#39;/item[subset=&#34;train&#34;]&#39;</span>
</code></pre></div><p>Example: extract a dataset with only large annotations of the <code>cat</code> class and
any non-<code>persons</code></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum filter <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -p test_project <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --mode annotations <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -e <span style="color:#4e9a06">&#39;/item/annotation[(label=&#34;cat&#34; and area &gt; 99.5) or label!=&#34;person&#34;]&#39;</span>
</code></pre></div><p>Example: extract a dataset with non-occluded annotations, remove empty images.
Use data only from the &ldquo;s1&rdquo; source of the project.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import --format voc -i &lt;path/to/dataset1/&gt; --name s1
datum import --format voc -i &lt;path/to/dataset2/&gt; --name s2
datum filter s1 <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -m i+a -e <span style="color:#4e9a06">&#39;/item/annotation[occluded=&#34;False&#34;]&#39;</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0c1db009ad311413c7036db1bd602bf0">12 - Generate Datasets</h1>
    
	<p>Creates a synthetic dataset with elements of the specified type and shape,
and saves it in the provided directory.</p>
<p>Currently, can only generate fractal images, useful for network compression.
To create 3-channel images, you should provide the number of images, height and width.
The images are colorized with a model, which will be downloaded automatically.
Uses the algorithm from the article: <a href="https://arxiv.org/abs/2103.13023">https://arxiv.org/abs/2103.13023</a></p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum generate <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -o OUTPUT_DIR -k COUNT --shape SHAPE <span style="color:#ce5c00;font-weight:bold">[</span>SHAPE ...<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-t <span style="color:#ce5c00;font-weight:bold">{</span>image<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--model-dir MODEL_PATH<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-o, --output-dir</code> (string) - Output directory</li>
<li><code>-k, --count</code> (integer) - Number of images to be generated</li>
<li><code>--shape</code> (integer, repeatable) - Dimensions of data to be generated (H, W)</li>
<li><code>-t, --type</code> (one of: <code>image</code>) - Specify the type of data to generate (default: <code>image</code>)</li>
<li><code>--model-dir</code> (path) - Path to load the colorization model from.
If no model is found, the model will be downloaded (default: current dir)</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty.</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:
Generate 300 3-channel fractal images with H=224, W=256 and store in the <code>images/</code> dir:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum generate -o images/ --count <span style="color:#0000cf;font-weight:bold">300</span> --shape <span style="color:#0000cf;font-weight:bold">224</span> <span style="color:#0000cf;font-weight:bold">256</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-08529e9683af8c1a879605b62306ea7a">13 - Print dataset info</h1>
    
	<p>This command outputs high level dataset information such as sample count,
categories and subsets.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum info <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--all<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>revpath<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.
By default, prints info about the joined <code>project</code> dataset.</li>
<li><code>--all</code> - Print all the information: do not fold long lists of labels etc.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<ul>
<li>
<p>Print info about a project dataset:
<code>datum info -p test_project/</code></p>
</li>
<li>
<p>Print info about a COCO-like dataset:
<code>datum info path/to/dataset:coco</code></p>
</li>
</ul>
<p>Sample output:</p>
<pre><code>length: 5000
categories: label
  label:
    count: 80
    labels: person, bicycle, car, motorcycle (and 76 more)
subsets: minival2014
  'minival2014':
    length: 5000
    categories: label
      label:
        count: 80
        labels: person, bicycle, car, motorcycle (and 76 more)
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-209bf2b1793403ac2d9c18c87a7dab54">14 - Log</h1>
    
	<p>This command prints the history of the current project revision.</p>
<p>Prints lines in the following format:
<code>&lt;short commit hash&gt; &lt;commit message&gt;</code></p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum log <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-n MAX_COUNT<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-n, --max-count</code> (number, default: 10) - The maximum number of
previous revisions in the output</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example output:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">affbh33 Added COCO dataset
eeffa35 Added VOC dataset
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6758bfd1eb71e4d0b6c4bf4aca1806f1">15 - Merge Datasets</h1>
    
	<p>Consider the following task: there is a set of images (the original dataset)
we want to annotate. Suppose we did this manually and/or automated it
using models, and now we have few sets of annotations for the same images.
We want to merge them and produce a single set of high-precision annotations.</p>
<p>Another use case: there are few datasets with different sets of images
and labels, which we need to combine in a single dataset. If the labels
were the same, we could just join the datasets. But in this case we need
to merge labels and adjust the annotations in the resulting dataset.</p>
<p>In Datumaro, it can be done with the <code>merge</code> command. This command merges 2
or more datasets and checks annotations for errors.</p>
<blockquote>
<p>In simple cases, when dataset images do not intersect and new
labels are not added, the recommended way of merging is using
<a href="../../../../docs/user-manual/command-reference/patch/">the <code>patch</code> command</a>.
It will offer better performance and provide the same results.</p>
</blockquote>
<p>Datasets are merged by items, and item annotations are merged by finding the
unique ones across datasets. Annotations are matched between matching dataset
items by distance. Spatial annotations are compared by the applicable distance
measure (IoU, OKS, PDJ etc.), labels and annotation attributes are selected
by voting. Each set of matching annotations produces a single annotation in
the resulting dataset. The <code>score</code> (a number in the range [0; 1]) attribute
indicates the agreement between different sources in the produced annotation.
The working time of the function can be estimated as
<code>O( (summary dataset length) * (dataset count) ^ 2 * (item annotations) ^ 2 )</code></p>
<p>This command also allows to merge datasets with different, or partially
overlapping sets of labels (which is impossible by simple joining).</p>
<p>During the process, some merge conflicts can appear. For example,
it can be mismatching dataset images having the same ids, label voting
can be unsuccessful if quorum is not reached (the <code>--quorum</code> parameter),
bboxes may be too close (the <code>-iou</code> parameter) etc. Found merge
conflicts, missing items or annotations, and other errors are saved into
an output <code>.json</code> file.</p>
<p>In Datumaro, annotations can be grouped. It can be useful to represent
different parts of a single object - for example, it can be different parts
of a human body, parts of a vehicle etc. This command allows to check
annotation groups for completeness with the <code>-g/--groups</code> option. If used,
this parameter must specify a list of labels for annotations that must be
in the same group. It can be particularly useful to check if separate
keypoints are grouped and all the necessary object components in the same
group.</p>
<p>This command has multiple forms:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">1<span style="color:#ce5c00;font-weight:bold">)</span> datum merge &lt;revpath&gt;
2<span style="color:#ce5c00;font-weight:bold">)</span> datum merge &lt;revpath&gt; &lt;revpath&gt; ...
</code></pre></div><p>&lt;revpath&gt; - either <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">a dataset path or a revision path</a>.</p>
<p>1 - Merges the current project&rsquo;s main target (&ldquo;project&rdquo;)
in the working tree with the specified dataset.</p>
<p>2 - Merges the specified datasets.
Note that the current project is not included in the list of merged
sources automatically.</p>
<p>The command supports passing extra exporting options for the output
dataset. The format can be specified with the <code>-f/--format</code> option.
Extra options should be passed after the main arguments
and after the <code>--</code> separator. Particularly, this is useful to include
images in the output dataset with <code>--save-images</code>.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum merge <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-iou IOU_THRESH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-oconf OUTPUT_CONF_THRESH<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>--quorum QUORUM<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-g GROUPS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-f FORMAT<span style="color:#ce5c00;font-weight:bold">]</span>
  target <span style="color:#ce5c00;font-weight:bold">[</span>target ...<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_FORMAT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpaths</a>
(repeatable)</li>
<li><code>-iou</code>, <code>--iou-thresh</code> (number) - IoU matching threshold for spatial
annotations (both maximum inter-cluster and pairwise). Default is 0.25.</li>
<li><code>--quorum</code> (number) - Minimum count of votes for a label or attribute
to be counted. Default is 0.</li>
<li><code>-g, --groups</code> (string) - A comma-separated list of label names in
annotation groups to check. The <code>?</code> postfix can be added to a label to
make it optional in the group (repeatable)</li>
<li><code>-oconf</code>, <code>--output-conf-thresh</code> (number) - Confidence threshold for output
annotations to be included in the resulting dataset. Default is 0.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a new directory
is created in the current directory.</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</li>
<li><code>-f, --format</code> (string) - Output format. The default format is <code>datumaro</code>.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra format args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Examples:</p>
<p>Merge 4 (partially-)intersecting projects,</p>
<ul>
<li>consider voting successful when there are no less than 3 same votes</li>
<li>consider shapes intersecting when IoU &gt;= 0.6</li>
<li>check annotation groups to have <code>person</code>, <code>hand</code>, <code>head</code> and <code>foot</code>
(<code>?</code> is used for optional parts)</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum merge project1/ project2/ project3/ project4/ <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --quorum <span style="color:#0000cf;font-weight:bold">3</span> <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -iou 0.6 <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --groups <span style="color:#4e9a06">&#39;person,hand?,head,foot?&#39;</span>
</code></pre></div><p>Merge images and annotations from 2 datasets in COCO format:
<code>datum merge dataset1/:image_dir dataset2/:coco dataset3/:coco</code></p>
<p>Check groups of the merged dataset for consistency:
look for groups consisting of <code>person</code>, <code>hand</code> <code>head</code>, <code>foot</code>
<code>datum merge project1/ project2/ -g 'person,hand?,head,foot?'</code></p>
<p>Merge two datasets, specify formats:
<code>datum merge path/to/dataset1:voc path/to/dataset2:coco</code></p>
<p>Merge the current working tree and a dataset:
<code>datum merge path/to/dataset2:coco</code></p>
<p>Merge a source from a previous revision and a dataset:
<code>datum merge HEAD~2:source-2 path/to/dataset2:yolo</code></p>
<p>Merge datasets and save in different format:
<code>datum merge -f voc dataset1/:yolo path2/:coco -- --save-images</code></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-db2ab356420634e305b5ea0550f9b9c3">16 - Models</h1>
    
	<p><a id="model-add"></a></p>
<h3 id="register-model">Register model</h3>
<p>Datumaro can execute deep learning models in various frameworks. Check
<a href="../../../../docs/user-manual/extending/#builtin-plugins">the plugins section</a>
for more info.</p>
<p>Supported frameworks:</p>
<ul>
<li>OpenVINO</li>
<li>Custom models via custom <code>launchers</code></li>
</ul>
<p>Models need to be added to the Datumaro project first. It can be done with
the <code>datum model add</code> command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum model add <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-n NAME<span style="color:#ce5c00;font-weight:bold">]</span> -l LAUNCHER <span style="color:#ce5c00;font-weight:bold">[</span>--copy<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--no-check<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-l, --launcher</code> (string) - Model launcher name</li>
<li><code>--copy</code> - Copy model data into project. By default, only the link is saved.</li>
<li><code>--no-check</code> - Don&rsquo;t check the model can be loaded</li>
<li><code>-n</code>, <code>--name</code> (string) - Name of the new model (default: generate
automatically)</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>&lt;extra args&gt;</code> - Additional arguments for the model launcher
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: register an OpenVINO model</p>
<p>A model consists of a graph description and weights. There is also a script
used to convert model outputs to internal data structures.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum model add <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -n &lt;model_name&gt; -l openvino -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -d &lt;path_to_xml&gt; -w &lt;path_to_bin&gt; -i &lt;path_to_interpretation_script&gt;
</code></pre></div><p>Interpretation script for an OpenVINO detection model (<code>convert.py</code>):
You can find OpenVINO model interpreter samples in
<code>datumaro/plugins/openvino/samples</code> (<a href="../../../../docs/plugins/openvino_plugin">instruction</a>).</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">datumaro</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">dm</span>

<span style="color:#000">max_det</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">10</span>
<span style="color:#000">conf_thresh</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0.1</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">process_outputs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#8f5902;font-style:italic"># inputs = model input, array or images, shape = (N, C, H, W)</span>
    <span style="color:#8f5902;font-style:italic"># outputs = model output, shape = (N, 1, K, 7)</span>
    <span style="color:#8f5902;font-style:italic"># results = conversion result, [ [ Annotation, ... ], ... ]</span>
    <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#204a87">input</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">output</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">zip</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inputs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">outputs</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">input_width</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">input</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">shape</span><span style="color:#000;font-weight:bold">[:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000">detections</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">output</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000">image_results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">det</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">detections</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">float</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">])</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">conf</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">conf_thresh</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#204a87;font-weight:bold">continue</span>

            <span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_width</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">max</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">w</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_width</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">input_width</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">h</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">min</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">int</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">det</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">input_height</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">input_height</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000">image_results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Bbox</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">w</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">h</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">label</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;score&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">conf</span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">))</span>

            <span style="color:#000">results</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image_results</span><span style="color:#000;font-weight:bold">[:</span><span style="color:#000">max_det</span><span style="color:#000;font-weight:bold">])</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">results</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_categories</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#8f5902;font-style:italic"># Optionally, provide output categories - label map etc.</span>
    <span style="color:#8f5902;font-style:italic"># Example:</span>
    <span style="color:#000">label_categories</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">LabelCategories</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000">label_categories</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;person&#39;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">label_categories</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;car&#39;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">dm</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">AnnotationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">label_categories</span> <span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><a id="model-remove"></a></p>
<h3 id="remove-models">Remove Models</h3>
<p>To remove a model from a project, use the <code>datum model remove</code> command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum model remove <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> name
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;name&gt;</code> (string) - The name of the model to be removed</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum model add &lt;...&gt; -n model1
datum remove model1
</code></pre></div><p><a id="model-run"></a></p>
<h3 id="run-model">Run Model</h3>
<p>This command applies model to dataset images and produces a new dataset.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum model run
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - A project build target to be used.
By default, uses the combined <code>project</code> target.</li>
<li><code>-m, --model</code> (string) - Model name</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, results will
be stored in an auto-generated directory in the current directory.</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example: launch inference on a dataset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import &lt;...&gt;
datum model add mymodel &lt;...&gt;
datum model run -m mymodel -o inference
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-160c03d29dec976c331bb969c9551cf4">17 - Patch Datasets</h1>
    
	<p>Updates items of the first dataset with items from the second one.</p>
<p>By default, datasets are updated in-place. The <code>-o/--output-dir</code>
option can be used to specify another output directory. When
updating in-place, use the <code>--overwrite</code> parameter along with the
<code>--save-images</code> export option (in-place updates fail by default
to prevent data loss).</p>
<p>Unlike the regular project <a href="../../../../api/api/developer_manual.html#merging">data source joining</a>,
the datasets are not required to have the same labels. The labels from
the &ldquo;patch&rdquo; dataset are projected onto the labels of the patched dataset,
so only the annotations with the matching labels are used, i.e.
all the annotations having unknown labels are ignored. Currently,
this command doesn&rsquo;t allow to update the label information in the
patched dataset.</p>
<p>The command supports passing extra exporting options for the output
dataset. The extra options should be passed after the main arguments
and after the <code>--</code> separator. Particularly, this is useful to include
images in the output dataset with <code>--save-images</code>.</p>
<p>This command can be applied to the current project targets or
arbitrary datasets outside a project. Note that if the target dataset
is read-only (e.g. if it is a project, stage or a cache entry),
the output directory must be provided.</p>
<p>Usage:</p>
<pre><code>datum patch [-h] [-o DST_DIR] [--overwrite] [-p PROJECT_DIR]
  target patch
  [-- EXPORT_ARGS]
</code></pre><p>&lt;revpath&gt; - either <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">a dataset path or a revision path</a>.</p>
<p>The current project (<code>-p/--project</code>) is also used as a context for
plugins, so it can be useful for dataset paths having custom formats.
When not specified, the current project&rsquo;s working tree is used.</p>
<p>Parameters:</p>
<ul>
<li><code>&lt;target dataset&gt;</code> (string) - Target <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a></li>
<li><code>&lt;patch dataset&gt;</code> (string) - Patch <a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a></li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, saves in-place</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;export args&gt;</code> - Additional arguments for the format writer
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Examples:</p>
<ul>
<li>Update a VOC-like dataset with COCO-like annotations:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch --overwrite dataset1/:voc dataset2/:coco -- --save-images
</code></pre></div><ul>
<li>Generate a patched dataset, based on a project:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch -o patched_proj1/ proj1/ proj2/
</code></pre></div><ul>
<li>Update the &ldquo;source1&rdquo; source in the current project with a dataset:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch -p proj/ --overwrite source1 path/to/dataset2:coco
</code></pre></div><ul>
<li>Generate a patched source from a previous revision and a dataset:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch -o new_src2/ HEAD~2:source-2 path/to/dataset2:yolo
</code></pre></div><ul>
<li>Update a dataset in a custom format, described in a project plugin:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum patch -p proj/ --overwrite dataset/:my_format dataset2/:coco
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-49c04c4e75f0995ee1c9c4c121d042c7">18 - Projects</h1>
    
	<p><a id="project-migrate"></a></p>
<h3 id="migrate-project">Migrate project</h3>
<p>Updates the project from an old version to the current one and saves the
resulting project in the output directory. Projects cannot be updated
inplace.</p>
<p>The command tries to map the old source configuration to the new one.
This can fail in some cases, so the command will exit with an error,
unless <code>-f/--force</code> is specified. With this flag, the command will
skip these errors an continue its work.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project migrate <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -o DST_DIR <span style="color:#ce5c00;font-weight:bold">[</span>-f<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-o, --output-dir</code> (string) - Output directory for the updated project</li>
<li><code>-f, --force</code> - Ignore source import errors (default: False)</li>
<li><code>--overwrite</code> - Overwrite existing files in the save directory.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<ul>
<li>Migrate a project from v1 to v2, save the new project in other dir:
<code>datum project migrate -o &lt;output/dir&gt;</code></li>
</ul>
<p><a id="project-info"></a></p>
<h3 id="print-project-info">Print project info</h3>
<p>Prints project configuration info such as available plugins, registered models,
imported sources and build tree.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum project info <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>revision<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;revision&gt;</code> (string) - Target project revision. By default,
uses the working tree.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Examples:</p>
<ul>
<li>
<p>Print project info for the current working tree:
<code>datum project info</code></p>
</li>
<li>
<p>Print project info for the previous revision:
<code>datum project info HEAD~1</code></p>
</li>
</ul>
<p>Sample output:</p>
<details>
<pre><code>Project:
  location: /test_proj

Plugins:
  extractors: ade20k2017, ade20k2020, camvid, cifar, cityscapes, coco, coco_captions, coco_image_info, coco_instances, coco_labels, coco_panoptic, coco_person_keypoints, coco_stuff, cvat, datumaro, icdar_text_localization, icdar_text_segmentation, icdar_word_recognition, image_dir, image_zip, imagenet, imagenet_txt, kitti, kitti_detection, kitti_raw, kitti_segmentation, label_me, lfw, market1501, mnist, mnist_csv, mot_seq, mots, mots_png, open_images, sly_pointcloud, tf_detection_api, vgg_face2, voc, voc_action, voc_classification, voc_detection, voc_layout, voc_segmentation, wider_face, yolo

  converters: camvid, mot_seq_gt, coco_captions, coco, coco_image_info, coco_instances, coco_labels, coco_panoptic, coco_person_keypoints, coco_stuff, kitti, kitti_detection, kitti_segmentation, icdar_text_localization, icdar_text_segmentation, icdar_word_recognition, lfw, datumaro, open_images, image_zip, cifar, yolo, voc_action, voc_classification, voc, voc_detection, voc_layout, voc_segmentation, tf_detection_api, label_me, mnist, cityscapes, mnist_csv, kitti_raw, wider_face, vgg_face2, sly_pointcloud, mots_png, image_dir, imagenet_txt, market1501, imagenet, cvat

  launchers:

Models:

Sources:
  'source-2':
    format: voc
    url: /datasets/pascal/VOC2012
    location: /test_proj/source-2/
    options: {}
    hash: 3eb282cdd7339d05b75bd932a1fd3201
    stages:
      'root':
        type: source
        hash: 3eb282cdd7339d05b75bd932a1fd3201
  'source-3':
    format: imagenet
    url: /datasets/imagenet/ILSVRC2012_img_val/train
    location: /test_proj/source-3/
    options: {}
    hash: e47804a3ec1a54c9b145e5f1007ec72f
    stages:
      'root':
        type: source
        hash: e47804a3ec1a54c9b145e5f1007ec72f
</code></pre></details>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dc182af461d71cbd7217b8679bde29bc">19 - Sources</h1>
    
	<p>These commands are specific for Data Sources. Read more about them <a href="../../../../docs/user-manual/how_to_use_datumaro#data-sources">here</a>.</p>
<p><a id="source-import"></a></p>
<h3 id="import-dataset">Import Dataset</h3>
<p>Datasets can be added to a Datumaro project with the <code>import</code> command,
which adds a dataset link into the project and downloads (or copies)
the dataset. If you need to add a dataset already copied into the project,
use the <a href="#source-add"><code>add</code></a> command.</p>
<p>Dataset format readers can provide some additional import options. To pass
such options, use the <code>--</code> separator after the main command arguments.
The usage information can be printed with <code>datum import -f &lt;format&gt; -- --help</code>.</p>
<p>The list of currently available formats is listed in the command help output.</p>
<p>A dataset is imported by its URL. Currently, only local filesystem
paths are supported. The URL can be a file or a directory path
to a dataset. When the dataset is read, it is read as a whole.
However, many formats can have multiple subsets like <code>train</code>, <code>val</code>, <code>test</code>
etc. If you want to limit reading only to a specific subset, use
the <code>-r/--path</code> parameter. It can also be useful when subset files have
non-standard placement or names.</p>
<p>When a dataset is imported, the following things are done:</p>
<ul>
<li>URL is saved in the project config</li>
<li>data in copied into the project</li>
</ul>
<p>Each data source has a name assigned, which can be used in other commands. To
set a specific name, use the <code>-n/--name</code> parameter.</p>
<p>The dataset is added into the working tree of the project. A new commit
is <em>not</em> done automatically.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum import <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-n NAME<span style="color:#ce5c00;font-weight:bold">]</span> -f FORMAT <span style="color:#ce5c00;font-weight:bold">[</span>-r PATH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--no-check<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> url <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_FORMAT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;url&gt;</code> (string) - A file of directory path to the dataset.</li>
<li><code>-f, --format</code> (string) - Dataset format</li>
<li><code>-r, --path</code> (string) - A path relative to the source URL the data source.
Useful to specify a path to a subset, subtask, or a specific file in URL.</li>
<li><code>--no-check</code> - Don&rsquo;t try to read the source after importing</li>
<li><code>-n</code>, <code>--name</code> (string) - Name of the new source (default: generate
automatically)</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra format args&gt;</code> - Additional arguments for the format reader
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: create a project from images and annotations in different formats,
export as TFrecord for TF Detection API for model training</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># &#39;default&#39; is the name of the subset below</span>
datum create
datum import -f coco_instances -r annotations/instances_default.json path/to/coco
datum import -f cvat &lt;path/to/cvat/default.xml&gt;
datum import -f voc_detection -r custom_subset_dir/default.txt &lt;path/to/voc&gt;
datum import -f datumaro &lt;path/to/datumaro/default.json&gt;
datum import -f image_dir &lt;path/to/images/dir&gt;
datum <span style="color:#204a87">export</span> -f tf_detection_api -- --save-images
</code></pre></div><p><a id="source-add"></a></p>
<h3 id="add-dataset">Add Dataset</h3>
<p>Existing datasets can be added to a Datumaro project with the <code>add</code> command.
The command adds a project-local directory as a data source in the project.
Unlike the <a href="#source-import"><code>import</code></a>
command, it does not copy datasets and only works with local directories.
The source name is defined by the directory name.</p>
<p>Dataset format readers can provide some additional import options. To pass
such options, use the <code>--</code> separator after the main command arguments.
The usage information can be printed with <code>datum add -f &lt;format&gt; -- --help</code>.</p>
<p>The list of currently available formats is listed in the command help output.</p>
<p>A dataset is imported as a directory. When the dataset is read, it is read
as a whole. However, many formats can have multiple subsets like <code>train</code>,
<code>val</code>, <code>test</code> etc. If you want to limit reading only to a specific subset,
use the <code>-r/--path</code> parameter. It can also be useful when subset files have
non-standard placement or names.</p>
<p>The dataset is added into the working tree of the project. A new commit
is <em>not</em> done automatically.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum add <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -f FORMAT <span style="color:#ce5c00;font-weight:bold">[</span>-r PATH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--no-check<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> path <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_FORMAT_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;url&gt;</code> (string) - A file of directory path to the dataset.</li>
<li><code>-f, --format</code> (string) - Dataset format</li>
<li><code>-r, --path</code> (string) - A path relative to the source URL the data source.
Useful to specify a path to a subset, subtask, or a specific file in URL.</li>
<li><code>--no-check</code> - Don&rsquo;t try to read the source after importing</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>-- &lt;extra format args&gt;</code> - Additional arguments for the format reader
(use <code>-- -h</code> for help). Must be specified after the main command arguments.</li>
</ul>
<p>Example: create a project from images and annotations in different formats,
export in YOLO for model training</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum add -f coco -r annotations/instances_train.json dataset1/
datum add -f cvat dataset2/train.xml
datum <span style="color:#204a87">export</span> -f yolo -- --save-images
</code></pre></div><p>Example: add an existing dataset into a project, avoid data copying</p>
<p>To add a dataset, we need to have it inside the project directory:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">proj/
├─ .datumaro/
├─ .dvc/
├─ my_coco/
│  └─ images/
│     ├─ image1.jpg
│     └─ ...
│  └─ annotations/
│     └─ coco_annotation.json
├─ .dvcignore
└─ .gitignore
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o proj/
mv ~/my_coco/ proj/my_coco/ <span style="color:#8f5902;font-style:italic"># move the dataset into the project directory</span>
datum add -p proj/ -f coco proj/my_coco/
</code></pre></div><p><a id="source-remove"></a></p>
<h3 id="remove-datasets">Remove Datasets</h3>
<p>To remove a data source from a project, use the <code>remove</code> command.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum remove <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--force<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--keep-data<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> name <span style="color:#ce5c00;font-weight:bold">[</span>name ...<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;name&gt;</code> (string) - The name of the source to be removed (repeatable)</li>
<li><code>-f, --force</code> - Do not fail and stop on errors during removal</li>
<li><code>--keep-data</code> - Do not remove source data from the working directory, remove
only project metainfo.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create
datum import -f voc -n src1 &lt;path/to/dataset/&gt;
datum remove src1
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-645d2da4c36696ec093ba5e3ce99c77c">20 - Get Project Statistics</h1>
    
	<p>This command computes various project statistics, such as:</p>
<ul>
<li>image mean and std. dev.</li>
<li>class and attribute balance</li>
<li>mask pixel balance</li>
<li>segment area distribution</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum stats <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target
<a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">source revpath</a>.
By default, computes statistics of the merged dataset.</li>
<li><code>-s, --subset</code> (string) - Compute stats only for a specific subset</li>
<li><code>--image-stats</code> (bool) - Compute image mean and std (default: True)</li>
<li><code>--ann-stats</code> (bool) - Compute annotation statistics (default: True)</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum stats -p test_project
</code></pre></div><p>Sample output:</p>
<details>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;annotations&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;labels&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;attributes&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">&#34;gender&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">358</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#204a87;font-weight:bold">&#34;female&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">149</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.41620111731843573</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;male&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">209</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.5837988826815642</span>
                        <span style="color:#000;font-weight:bold">]</span>
                    <span style="color:#000;font-weight:bold">},</span>
                    <span style="color:#204a87;font-weight:bold">&#34;values count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;values present&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                        <span style="color:#4e9a06">&#34;female&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;male&#34;</span>
                    <span style="color:#000;font-weight:bold">]</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#204a87;font-weight:bold">&#34;view&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">340</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                        <span style="color:#204a87;font-weight:bold">&#34;__undefined__&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.011764705882352941</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;front&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">54</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.1588235294117647</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;left&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">14</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.041176470588235294</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;rear&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">235</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.6911764705882353</span>
                        <span style="color:#000;font-weight:bold">],</span>
                        <span style="color:#204a87;font-weight:bold">&#34;right&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                            <span style="color:#0000cf;font-weight:bold">33</span><span style="color:#000;font-weight:bold">,</span>
                            <span style="color:#0000cf;font-weight:bold">0.09705882352941177</span>
                        <span style="color:#000;font-weight:bold">]</span>
                    <span style="color:#000;font-weight:bold">},</span>
                    <span style="color:#204a87;font-weight:bold">&#34;values count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;values present&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                        <span style="color:#4e9a06">&#34;__undefined__&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;front&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;left&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;rear&#34;</span><span style="color:#000;font-weight:bold">,</span>
                        <span style="color:#4e9a06">&#34;right&#34;</span>
                    <span style="color:#000;font-weight:bold">]</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">},</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2038</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">&#34;car&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">340</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.16683022571148184</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;cyclist&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">194</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.09519136408243375</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;head&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">354</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.17369970559371933</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;ignore&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.04906771344455348</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;left_hand&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">238</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.11678115799803729</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;person&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">358</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.17566241413150147</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;right_hand&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">77</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.037782139352306184</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;road_arrows&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">326</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.15996074582924436</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;traffic_sign&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">51</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.025024533856722278</span>
                <span style="color:#000;font-weight:bold">]</span>
            <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;segments&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;area distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1318</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">11425.1</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.9627465303140978</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">22850.2</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">11425.1</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0007304601899196494</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">34275.3</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">22850.2</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">45700.4</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">34275.3</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">57125.5</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">45700.4</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">68550.6</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">57125.5</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">79975.7</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">68550.6</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">91400.8</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">79975.7</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">102825.90000000001</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">91400.8</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">},</span>
                <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">50</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;max&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">114251.0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;min&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">102825.90000000001</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#204a87;font-weight:bold">&#34;percent&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.036523009495982466</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">],</span>
            <span style="color:#204a87;font-weight:bold">&#34;avg. area&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5411.624543462382</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;pixel distribution&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">&#34;car&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">13655</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0018431496518735067</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;cyclist&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">939005</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.12674674030446592</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;head&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;ignore&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">5501200</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.7425510702956085</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;left_hand&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;person&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">954654</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.12885903974805205</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;right_hand&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;road_arrows&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">],</span>
                <span style="color:#204a87;font-weight:bold">&#34;traffic_sign&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#0000cf;font-weight:bold">0.0</span>
                <span style="color:#000;font-weight:bold">]</span>
            <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#204a87;font-weight:bold">&#34;annotations by type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;bbox&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">548</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;caption&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;mask&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;points&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">669</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;polygon&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">821</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#204a87;font-weight:bold">&#34;polyline&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#204a87;font-weight:bold">&#34;annotations count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">2038</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;unannotated images&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#4e9a06">&#34;img00051&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#34;img00052&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#34;img00053&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#34;img00054&#34;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#34;img00055&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000;font-weight:bold">],</span>
    <span style="color:#204a87;font-weight:bold">&#34;unannotated images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">,</span>

    <span style="color:#204a87;font-weight:bold">&#34;dataset&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;unique images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">97</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;repeated images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#204a87;font-weight:bold">&#34;repeated images&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
            <span style="color:#000;font-weight:bold">[[</span><span style="color:#4e9a06">&#34;img00057&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;img00058&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">]],</span>
            <span style="color:#000;font-weight:bold">[[</span><span style="color:#4e9a06">&#34;img00059&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;img00060&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">]],</span>
            <span style="color:#000;font-weight:bold">[[</span><span style="color:#4e9a06">&#34;img00061&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;img00062&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;default&#34;</span><span style="color:#000;font-weight:bold">]],</span>
        <span style="color:#000;font-weight:bold">],</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#204a87;font-weight:bold">&#34;subsets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">&#34;default&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;images count&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;image mean&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                <span style="color:#0000cf;font-weight:bold">107.06903686941979</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#0000cf;font-weight:bold">79.12831698580979</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#0000cf;font-weight:bold">52.95829558185416</span>
            <span style="color:#000;font-weight:bold">],</span>
            <span style="color:#204a87;font-weight:bold">&#34;image std&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
                <span style="color:#0000cf;font-weight:bold">49.40237673503467</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#0000cf;font-weight:bold">43.29600731496902</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#0000cf;font-weight:bold">35.47373007603151</span>
            <span style="color:#000;font-weight:bold">],</span>

        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">},</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div></details>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a818e6c810d9d8ef27c2b0f440145895">21 - Status</h1>
    
	<p>This command prints the summary of the source changes between
the working tree of a project and its HEAD revision.</p>
<p>Prints lines in the following format:
<code>&lt;status&gt; &lt;source name&gt;</code></p>
<p>The list of possible <code>status</code> values:</p>
<ul>
<li><code>modified</code> - the source data exists and it is changed</li>
<li><code>foreign_modified</code> - the source data exists and it is changed,
but Datumaro does not know about the way the differences were made.
If changes are committed, they will only be available for reproduction
from the project cache.</li>
<li><code>added</code> - the source was added in the working tree</li>
<li><code>removed</code> - the source was removed from the working tree. This status won&rsquo;t
be reported if just the source <em>data</em> is removed in the working tree.
In such situation the status will be <code>missing</code>.</li>
<li><code>missing</code> - the source data is removed from the working directory.
The source still can be restored from the project cache or reproduced.</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum status <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
</ul>
<p>Example output:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">added source-1
modified source-2
foreign_modified source-3
removed source-4
missing source-5
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-86897105a5f038a99bfe0935866c69ce">22 - Transform Dataset</h1>
    
	<p>Often datasets need to be modified during preparation for model training and
experimenting. In trivial cases it can be done manually - e.g. image renaming
or label renaming. However, in more complex cases even simple modifications
can require too much efforts, distracting the user from the real work.
Datumaro provides the <code>datum transform</code> command to help in such cases.</p>
<p>This command allows to modify dataset images or annotations all at once.</p>
<blockquote>
<p>This command is designed for batch dataset processing, so if you only
need to modify few elements of a dataset, you might want to use
other approaches for better performance. A possible solution can be
a simple script, which uses <a href="../../../../api/api/developer_manual.html">Datumaro API</a>.</p>
</blockquote>
<p>The command can be applied to a dataset or a project build target,
a stage or the combined <code>project</code> target, in which case all the project
targets will be affected. A build tree stage will be recorded
if <code>--stage</code> is enabled, and the resulting dataset(-s) will be
saved if <code>--apply</code> is enabled.</p>
<p>By default, datasets are updated in-place. The <code>-o/--output-dir</code>
option can be used to specify another output directory. When
updating in-place, use the <code>--overwrite</code> parameter (in-place
updates fail by default to prevent data loss), unless a project
target is modified.</p>
<p>The current project (<code>-p/--project</code>) is also used as a context for
plugins, so it can be useful for dataset paths having custom formats.
When not specified, the current project&rsquo;s working tree is used.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -t TRANSFORM <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--stage STAGE<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--apply APPLY<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target
<a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.
By default, transforms all targets of the current project.</li>
<li><code>-t, --transform</code> (string) - Transform method name</li>
<li><code>--stage</code> (bool) - Include this action as a project build step.
If true, this operation will be saved in the project
build tree, allowing to reproduce the resulting dataset later.
Applicable only to main project targets (i.e. data sources
and the <code>project</code> target, but not intermediate stages). Enabled by default.</li>
<li><code>--apply</code> (bool) - Run this command immediately. If disabled, only the
build tree stage will be written. Enabled by default.</li>
<li><code>-o, --output-dir</code> (string) - Output directory. Can be omitted for
main project targets (i.e. data sources and the <code>project</code> target, but not
intermediate stages) and dataset targets. If not specified, the results
will be saved inplace.</li>
<li><code>--overwrite</code> - Allows to overwrite existing files in the output directory,
when it is specified and is not empty.</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>&lt;extra args&gt;</code> - The list of extra transformation parameters. Should be
passed after the <code>--</code> separator after the main command arguments. See
transform descriptions for info about extra parameters. Use the <code>--help</code>
option to print parameter info.</li>
</ul>
<p>Examples:</p>
<ul>
<li>Split a VOC-like dataset randomly:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t random_split --overwrite path/to/dataset:voc
</code></pre></div><ul>
<li>Rename images in a project data source by a regex from <code>frame_XXX</code> to <code>XXX</code>:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create &lt;...&gt;
datum import &lt;...&gt; -n source-1
datum transform -t rename source-1 -- -e <span style="color:#4e9a06">&#39;|^frame_||&#39;</span>
</code></pre></div><p><a id="builtin-transforms"></a></p>
<h4 id="built-in-transforms">Built-in transforms</h4>
<p>Basic dataset item manipulations:</p>
<ul>
<li><a href="#rename-transform"><code>rename</code></a> - Renames dataset items by regular expression</li>
<li><a href="#id_from_image_name-transform"><code>id_from_image_name</code></a> - Renames dataset
items to their image filenames</li>
<li><a href="#reindex-transform"><code>reindex</code></a> - Renames dataset items with numbers</li>
<li><a href="#ndr-transform"><code>ndr</code></a> - Removes duplicated images from dataset</li>
<li><a href="#relevancy_sampler-transform"><code>relevancy_sampler</code></a> - Leaves only the most
important images
(requires model inference results)</li>
<li><a href="#random_sampler-transform"><code>random_sampler</code></a> - Leaves no more than k items
from the dataset randomly</li>
<li><a href="#label_random_sampler-transform"><code>label_random_sampler</code></a> - Leaves at least
k images with annotations per class</li>
<li><a href="#resize-transform"><code>resize</code></a> - Resizes images and annotations in the dataset</li>
<li><a href="#remove_images-transform"><code>remove_images</code></a> - Removes specific images</li>
<li><a href="#remove_annotations-transform"><code>remove_annotations</code></a> - Removes annotations</li>
<li><a href="#remove_attributes-transform"><code>remove_attributes</code></a> - Removes attributes</li>
</ul>
<p>Subset manipulations:</p>
<ul>
<li><a href="#random_split-transform"><code>random_split</code></a> - Splits dataset into subsets
randomly</li>
<li><a href="#split-transform"><code>split</code></a> - Splits dataset into subsets for classification,
detection, segmentation or re-identification</li>
<li><a href="#map_subsets-transform"><code>map_subsets</code></a> - Renames and removes subsets</li>
</ul>
<p>Annotation manipulations:</p>
<ul>
<li><a href="#remap_labels-transform"><code>remap_labels</code></a> - Renames, adds or removes
labels in dataset</li>
<li><a href="#project_labels-transform"><code>project_labels</code></a> - Sets dataset labels to
the requested sequence</li>
<li><a href="#shapes_to_boxes-transform"><code>shapes_to_boxes</code></a> - Replaces spatial
annotations with bounding boxes</li>
<li><a href="#boxes_to_masks-transform"><code>boxes_to_masks</code></a> - Converts bounding boxes
to instance masks</li>
<li><a href="#polygons_to_masks-transform"><code>polygons_to_masks</code></a> - Converts polygons
to instance masks</li>
<li><a href="#masks_to_polygons-transform"><code>masks_to_polygons</code></a> - Converts instance
masks to polygons</li>
<li><a href="#anns_to_labels-transform"><code>anns_to_labels</code></a> - Replaces annotations having
labels with label annotations</li>
<li><a href="#merge_instance_segments-transform"><code>merge_instance_segments</code></a> - Merges
grouped spatial annotations into a mask</li>
<li><a href="#crop_covered_segments-transform"><code>crop_covered_segments</code></a> - Removes
occluded segments of covered masks</li>
<li><a href="#bbox_value_decrement-transform"><code>bbox_value_decrement</code></a> - Subtracts
1 from bbox coordinates</li>
</ul>
<p><a id="rename-transform"></a></p>
<h5 id="rename"><code>rename</code></h5>
<p>Renames items in the dataset. Supports regular expressions.
The first character in the expression is a delimiter for
the pattern and replacement parts. Replacement part can also
contain <code>str.format</code> replacement fields with the <code>item</code>
(of type <code>DatasetItem</code>) object available.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rename <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e REGEX<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-e</code>, <code>--regex</code> (string) - Regex for renaming in the form
<code>&lt;sep&gt;&lt;search&gt;&lt;sep&gt;&lt;replacement&gt;&lt;sep&gt;</code></li>
</ul>
<p>Examples:
Replace &lsquo;pattern&rsquo; with &lsquo;replacement&rsquo;:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t rename -- -e <span style="color:#4e9a06">&#39;|pattern|replacement|&#39;</span>
</code></pre></div><p>Remove the <code>frame_</code> prefix from item ids:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t rename -- -e <span style="color:#4e9a06">&#39;|^frame_|\1|&#39;</span>
</code></pre></div><p>Collect images from subdirectories into the base image directory using regex:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t rename -- -e <span style="color:#4e9a06">&#39;|^((.+[/\\])*)?(.+)$|\2|&#39;</span>
</code></pre></div><p>Add subset prefix to images:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t rename -- -e <span style="color:#4e9a06">&#39;|(.*)|{item.subset}_\1|&#39;</span>
</code></pre></div><p><a id="id_from_image_name-transform"></a></p>
<h5 id="id_from_image_name"><code>id_from_image_name</code></h5>
<p>Renames items in the dataset using image file name (without extension).</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">id_from_image_name <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="reindex-transform"></a></p>
<h5 id="reindex"><code>reindex</code></h5>
<p>Replaces dataset item IDs with sequential indices.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">reindex <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s START<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-s</code>, <code>--start</code> (int) - Start value for item ids (default: 1)</li>
</ul>
<p><a id="ndr-transform"></a></p>
<h5 id="ndr"><code>ndr</code></h5>
<p>Removes near-duplicated images in subset.</p>
<p>Remove duplicated images from a dataset. Keep at most <code>-k/--num_cut</code>
resulting images.</p>
<p>Available oversampling policies (the <code>-e</code> parameter):</p>
<ul>
<li><code>random</code> - sample from removed data randomly</li>
<li><code>similarity</code> - sample from removed data with ascending similarity score</li>
</ul>
<p>Available undersampling policies (the <code>-u</code> parameter):</p>
<ul>
<li><code>uniform</code> - sample data with uniform distribution</li>
<li><code>inverse</code> - sample data with reciprocal of the number of number of
items with the same similarity</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ndr <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-w WORKING_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-d DUPLICATED_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-a <span style="color:#ce5c00;font-weight:bold">{</span>gradient<span style="color:#ce5c00;font-weight:bold">}]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-k NUM_CUT<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e <span style="color:#ce5c00;font-weight:bold">{</span>random,similarity<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-u <span style="color:#ce5c00;font-weight:bold">{</span>uniform,inverse<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-w</code>, <code>--working_subset</code> (str) - Name of the subset to operate
(default: <code>None</code>)</li>
<li><code>-d</code>, <code>--duplicated_subset</code> (str) - Name of the subset for the removed
data after NDR runs (default: duplicated)</li>
<li><code>-a</code>, <code>--algorithm</code> (one of: <code>gradient</code>) - Name of the algorithm to
use (default: <code>gradient</code>)</li>
<li><code>-k</code>, <code>--num_cut</code> (int) - Maximum output dataset size</li>
<li><code>-e</code>, <code>--over_sample</code> (one of: <code>random</code>, <code>similarity</code>) - The policy to use
when <code>num_cut</code> is bigger than result length (default: <code>random</code>)</li>
<li><code>-u</code>, <code>--under_sample</code> (one of: <code>uniform</code>, <code>inverse</code>) - The policy to use
when <code>num_cut</code> is smaller than result length (default: <code>uniform</code>)</li>
<li><code>-s</code>, <code>--seed</code> (int) - Random seed</li>
</ul>
<p>Example: apply NDR, return no more than 100 images</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t ndr -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --working_subset train
  --algorithm gradient
  --num_cut <span style="color:#0000cf;font-weight:bold">100</span>
  --over_sample random
  --under_sample uniform
</code></pre></div><p><a id="relevancy_sampler-transform"></a></p>
<h5 id="relevancy_sampler"><code>relevancy_sampler</code></h5>
<p>Sampler that analyzes model inference results on the dataset
and picks the most relevant samples for training.</p>
<p>Creates a dataset from the <code>-k/--count</code> hardest items for a model.
The whole dataset or a single subset will be split into the <code>sampled</code>
and <code>unsampled</code> subsets based on the model confidence. The dataset
<strong>must</strong> contain model confidence values in the <code>scores</code> attributes
of annotations.</p>
<p>There are five methods of sampling (the <code>-m/--method</code> option):</p>
<ul>
<li><code>topk</code> - Return the k items with the highest uncertainty data</li>
<li><code>lowk</code> - Return the k items with the lowest uncertainty data</li>
<li><code>randk</code> - Return random k items</li>
<li><code>mixk</code> - Return a half using topk, and the other half using lowk method</li>
<li><code>randtopk</code> - Select 3*k items randomly, and return the topk among them</li>
</ul>
<p>Notes:</p>
<ul>
<li>Each image&rsquo;s inference result must contain the probability for
all classes (in the <code>scores</code> attribute).</li>
<li>Requesting a sample larger than the number of all images will return
all images.</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">relevancy_sampler <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -k COUNT <span style="color:#ce5c00;font-weight:bold">[</span>-a <span style="color:#ce5c00;font-weight:bold">{</span>entropy<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-i INPUT_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-o SAMPLED_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-u UNSAMPLED_SUBSET<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-m <span style="color:#ce5c00;font-weight:bold">{</span>topk,lowk,randk,mixk,randtopk<span style="color:#ce5c00;font-weight:bold">}]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-d OUTPUT_FILE<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-k</code>, <code>--count</code> (int) - Number of items to sample</li>
<li><code>-a</code>, <code>--algorithm</code> (one of: <code>entropy</code>) - Sampling
algorithm (default: <code>entropy</code>)</li>
<li><code>-i</code>, <code>--input_subset</code> (str) - Subset name to select sample
from (default: <code>None</code>)</li>
<li><code>-o</code>, <code>--sampled_subset</code> (str) - Subset name to put sampled data
to (default: <code>sample</code>)</li>
<li><code>-u</code>, <code>--unsampled_subset</code> (str) - Subset name to put the
rest data to (default: <code>unsampled</code>)</li>
<li><code>-m</code>, <code>--sampling_method</code> (one of: <code>topk</code>, <code>lowk</code>, <code>randk</code>, <code>mixk</code>,
<code>randtopk</code>) - Sampling method (default: <code>topk</code>)</li>
<li><code>-d</code>, <code>--output_file</code> (path) - A <code>.csv</code> file path to dump sampling results</li>
</ul>
<p>Examples:
Select the most relevant data subset of 20 images
based on model certainty, put the result into <code>sample</code> subset
and put all the rest into <code>unsampled</code> subset, use <code>train</code> subset
as input. The dataset <strong>must</strong> contain model confidence values in the <code>scores</code>
attributes of annotations.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t relevancy_sampler -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --algorithm entropy <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --subset_name train <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --sample_name sample <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --unsampled_name unsampled <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --sampling_method topk -k <span style="color:#0000cf;font-weight:bold">20</span>
</code></pre></div><p><a id="random_sampler-transform"></a></p>
<h5 id="random_sampler"><code>random_sampler</code></h5>
<p>Sampler that keeps no more than required number of items in the dataset.</p>
<p>Notes:</p>
<ul>
<li>Items are selected uniformly (tries to keep original item distribution
by subsets)</li>
<li>Requesting a sample larger than the number of all images will return
all images</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">random_sampler <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -k COUNT <span style="color:#ce5c00;font-weight:bold">[</span>-s SUBSET<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--seed SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-k</code>, <code>--count</code> (int) - Maximum number of items to sample</li>
<li><code>-s</code>, <code>--subset</code> (str) - Limit changes to this subset
(default: affect all dataset)</li>
<li><code>--seed</code> (int) - Initial value for random number generator</li>
</ul>
<p>Examples:
Select subset of 20 images randomly</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t random_sampler -- -k <span style="color:#0000cf;font-weight:bold">20</span>
</code></pre></div><p>Select subset of 20 images, modify only <code>train</code> subset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t random_sampler -- -k <span style="color:#0000cf;font-weight:bold">20</span> -s train
</code></pre></div><p><a id="label_random_sampler-transform"></a></p>
<h5 id="random_label_sampler"><code>random_label_sampler</code></h5>
<p>Sampler that keeps at least the required number of annotations of
each class in the dataset for each subset separately.</p>
<p>Consider using the &ldquo;stats&rdquo; command to get class distribution in the dataset.</p>
<p>Notes:</p>
<ul>
<li>Items can contain annotations of several selected classes
(e.g. 3 bounding boxes per image). The number of annotations in the
resulting dataset varies between <code>max(class counts)</code> and <code>sum(class counts)</code></li>
<li>If the input dataset does not has enough class annotations, the result
will contain only what is available</li>
<li>Items are selected uniformly</li>
<li>For reasons above, the resulting class distribution in the dataset may
not be the same as requested</li>
<li>The resulting dataset will only keep annotations for classes with
specified <code>count</code> &gt; 0</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">label_random_sampler <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -k COUNT <span style="color:#ce5c00;font-weight:bold">[</span>-l LABEL_COUNTS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--seed SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-k</code>, <code>--count</code> (int) - Minimum number of annotations of each class</li>
<li><code>-l</code>, <code>--label</code> (str; repeatable) - Minimum number of annotations of
a specific class. Overrides the <code>-k/--count</code> setting for the class.
The format is <code>&lt;label_name&gt;:&lt;count&gt;</code></li>
<li><code>--seed</code> (int) - Initial value for random number generator</li>
</ul>
<p>Examples:
Select a dataset with at least 10 images of each class:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t label_random_sampler -- -k <span style="color:#0000cf;font-weight:bold">10</span>
</code></pre></div><p>Select a dataset with at least 20 <code>cat</code> images, 5 <code>dog</code>, 0 <code>car</code> and 10 of each
unmentioned class:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t label_random_sampler -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -l cat:20 <span style="color:#4e9a06">\ </span><span style="color:#8f5902;font-style:italic"># keep 20 images with cats</span>
  -l dog:5 <span style="color:#4e9a06">\ </span><span style="color:#8f5902;font-style:italic"># keep 5 images with dogs</span>
  -l car:0 <span style="color:#4e9a06">\ </span><span style="color:#8f5902;font-style:italic"># remove car annotations</span>
  -k <span style="color:#0000cf;font-weight:bold">10</span> <span style="color:#8f5902;font-style:italic"># for remaining classes</span>
</code></pre></div><p><a id="resize-transform"></a></p>
<h5 id="resize"><code>resize</code></h5>
<p>Resizes images and annotations in the dataset to the specified size.
Supports upscaling, downscaling and mixed variants.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">resize <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-dw WIDTH<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-dh HEIGHT<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-dw</code>, <code>--width</code> (int) - Destination image width</li>
<li><code>-dh</code>, <code>--height</code> (int) - Destination image height</li>
</ul>
<p>Examples:
Resize all images to 256x256 size</p>
<pre><code>datum transform -t resize -- -dw 256 -dh 256
</code></pre><p><a id="remove_images-transform"></a></p>
<h5 id="remove_images"><code>remove_images</code></h5>
<p>Removes specific dataset items by their ids.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">remove_images <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--id IDs<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>--id</code> (str) - Item id to remove. Id is &lsquo;<name>:<subset>&rsquo; pair (repeatable)</li>
</ul>
<p>Examples:</p>
<p>Remove specific images from the dataset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remove_images -- --id <span style="color:#4e9a06">&#39;image1:train&#39;</span> --id <span style="color:#4e9a06">&#39;image2:test&#39;</span>
</code></pre></div><p><a id="remove_annotations-transform"></a></p>
<h5 id="remove_annotations"><code>remove_annotations</code></h5>
<p>Allows to remove annotations on specific dataset items.</p>
<p>Can be useful to clean the dataset from broken or unnecessary annotations.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">remove_annotations <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--id IDs<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>--id</code> (str) - Item id to clean from annotations. Id is &lsquo;<name>:<subset>&rsquo; pair.
If not specified, removes all annotations (repeatable)</li>
</ul>
<p>Examples:
Remove annotations from specific items in the dataset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remove_annotations -- --id <span style="color:#4e9a06">&#39;image1:train&#39;</span> --id <span style="color:#4e9a06">&#39;image2:test&#39;</span>
</code></pre></div><p><a id="remove_attributes-transform"></a></p>
<h5 id="remove_attributes"><code>remove_attributes</code></h5>
<p>Allows to remove item and annotation attributes in a dataset.</p>
<p>Can be useful to clean the dataset from broken or unnecessary attributes.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">remove_attributes <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--id IDs<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--attr ATTRIBUTE_NAME<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>--id</code> (str) - Image id to clean from annotations. Id is &lsquo;<name>:<subset>&rsquo; pair.
If not specified, affects all items and annotations (repeatable)</li>
<li><code>-a</code>, <code>--attr</code> (flag) - Attribute name to be removed. If not specified,
removes all attributes (repeatable)</li>
</ul>
<p>Examples:
Remove the <code>is_crowd</code> attribute from dataset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remove_attributes -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --attr <span style="color:#4e9a06">&#39;is_crowd&#39;</span>
</code></pre></div><p>Remove the <code>occluded</code> attribute from annotations of
the <code>2010_001705</code> item in the <code>train</code> subset</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remove_attributes -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  --id <span style="color:#4e9a06">&#39;2010_001705:train&#39;</span> --attr <span style="color:#4e9a06">&#39;occluded&#39;</span>
</code></pre></div><p><a id="random_split-transform"></a></p>
<h5 id="random_split"><code>random_split</code></h5>
<p>Joins all subsets into one and splits the result into few parts.
It is expected that item ids are unique and subset ratios sum up to 1.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">random_split <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s SPLITS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--seed SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-s</code>, <code>--subset</code> (str, repeatable) - Subsets in the form: &lsquo;<subset>:<ratio>&rsquo;
(repeatable, default: {<code>train</code>: 0.67, <code>test</code>: 0.33})</li>
<li><code>--seed</code> (int) - Random seed</li>
</ul>
<p>Example:
Split a dataset randomly to <code>train</code> and <code>test</code> subsets, ratio is 2:1</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t random_split -- --subset train:.67 --subset test:.33
</code></pre></div><p><a id="split-transform"></a></p>
<h5 id="split"><code>split</code></h5>
<p>Splits a dataset for model training, using task information:</p>
<ul>
<li>
<p>classification splits
Splits dataset into subsets (train/val/test) in class-wise manner.
Splits dataset images in the specified ratio, keeping the initial
class distribution.</p>
</li>
<li>
<p>detection &amp; segmentation splits
Each image can have multiple object annotations - bbox, mask, polygon.
Since an image shouldn&rsquo;t be included in multiple subsets at the same time,
and image annotations shouldn&rsquo;t be split, in general, dataset annotations are
unlikely to be split exactly in the specified ratio.
This split tries to split dataset images as close as possible to the specified
ratio, keeping the initial class distribution.</p>
</li>
<li>
<p>reidentification splits
In this task, the test set should consist of images of unseen people or
objects during the training phase.
This function splits a dataset in the following way:</p>
</li>
</ul>
<ol>
<li>Splits the dataset into <code>train + val</code> and <code>test</code> sets
based on person or object ID.</li>
<li>Splits <code>test</code> set into <code>test-gallery</code> and <code>test-query</code> sets
in class-wise manner.</li>
<li>Splits the <code>train + val</code> set into <code>train</code> and <code>val</code> sets
in the same way.
The final subsets would be <code>train</code>, <code>val</code>, <code>test-gallery</code> and <code>test-query</code>.</li>
</ol>
<p>Notes:</p>
<ul>
<li>Each image is expected to have only one <code>Annotation</code>. Unlabeled or
multi-labeled images will be split into subsets randomly.</li>
<li>If Labels also have attributes, also splits by attribute values.</li>
<li>If there is not enough images in some class or attributes group,
the split ratio can&rsquo;t be guaranteed.</li>
</ul>
<p>In reidentification task,</p>
<ul>
<li>Object ID can be described by Label, or by attribute (<code>--attr</code> parameter)</li>
<li>The splits of the test set are controlled by <code>--query</code> parameter
Gallery ratio would be <code>1.0 - query</code>.</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">split <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-t <span style="color:#ce5c00;font-weight:bold">{</span>classification,detection,segmentation,reid<span style="color:#ce5c00;font-weight:bold">}]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-s SPLITS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--query QUERY<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--attr ATTR_FOR_ID<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--seed SEED<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-t</code>, <code>--task</code> (one of: <code>classification</code>, <code>detection</code>, <code>segmentation</code>,
<code>reid</code>) - Dataset task (default: <code>classification</code>)</li>
<li><code>-s</code>, <code>--subset</code> (str; repeatable) - Subsets in the form: &lsquo;<subset>:<ratio>&rsquo;
(default: {<code>train</code>: 0.5, <code>val</code>: 0.2, <code>test</code>: 0.3})</li>
<li><code>--query</code> (float) - Query ratio in the test set (default: 0.5)</li>
<li><code>--attr</code> (str) - Attribute name representing the ID (default: use label)</li>
<li><code>--seed</code>(int) - Random seed</li>
</ul>
<p>Example:</p>
<pre><code>datum transform -t split -- -t classification \
  --subset train:.5 --subset val:.2 --subset test:.3

datum transform -t split -- -t detection \
  --subset train:.5 --subset val:.2 --subset test:.3

datum transform -t split -- -t segmentation \
  --subset train:.5 --subset val:.2 --subset test:.3

datum transform -t split -- -t reid \
  --subset train:.5 --subset val:.2 --subset test:.3 --query .5
</code></pre><p>Example: use <code>person_id</code> attribute for splitting</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t split -- -t detection --attr person_id
</code></pre></div><p><a id="map_subsets-transform"></a></p>
<h5 id="map_subsets"><code>map_subsets</code></h5>
<p>Renames subsets in the dataset.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">map_subsets <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s MAPPING<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-s</code>, <code>--subset</code> (str; repeatable) - Subset mapping of the form: <code>src:dst</code></li>
</ul>
<p><a id="remap_labels-transform"></a></p>
<h5 id="remap_labels"><code>remap_labels</code></h5>
<p>Changes labels in the dataset.</p>
<p>A label can be:</p>
<ul>
<li>renamed (and joined with existing) -
when <code>--label &lt;old_name&gt;:&lt;new_name&gt;</code> is specified</li>
<li>deleted - when <code>--label &lt;name&gt;:</code> is specified, or default action is <code>delete</code>
and the label is not mentioned in the list. When a label
is deleted, all the associated annotations are removed</li>
<li>kept unchanged - when <code>--label &lt;name&gt;:&lt;name&gt;</code> is specified,
or default action is <code>keep</code> and the label is not mentioned in the list
Annotations with no label are managed by the default action policy.</li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">remap_labels <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-l MAPPING<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--default <span style="color:#ce5c00;font-weight:bold">{</span>keep,delete<span style="color:#ce5c00;font-weight:bold">}]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-l</code>, <code>--label</code> (str; repeatable) - Label in the form of: <code>&lt;src&gt;:&lt;dst&gt;</code></li>
<li><code>--default</code> (one of: <code>keep</code>, <code>delete</code>) - Action for unspecified labels
(default: <code>keep</code>)</li>
</ul>
<p>Examples:
Remove the <code>person</code> label (and corresponding annotations):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remap_labels -- -l person: --default keep
</code></pre></div><p>Rename <code>person</code> to <code>pedestrian</code> and <code>human</code> to <code>pedestrian</code>, join annotations
that had different classes under the same class id for <code>pedestrian</code>,
don&rsquo;t touch other classes:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remap_labels -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -l person:pedestrian -l human:pedestrian --default keep
</code></pre></div><p>Rename <code>person</code> to <code>car</code> and <code>cat</code> to <code>dog</code>, keep <code>bus</code>, remove others:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t remap_labels -- <span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>  -l person:car -l bus:bus -l cat:dog --default delete
</code></pre></div><p><a id="project_labels-transform"></a></p>
<h5 id="project_labels"><code>project_labels</code></h5>
<p>Changes the order of labels in the dataset from the existing
to the desired one, removes unknown labels and adds new labels.
Updates or removes the corresponding annotations.</p>
<p>Labels are matched by names (case dependent). Parent labels are
only kept if they are present in the resulting set of labels.
If new labels are added, and the dataset has mask colors defined,
new labels will obtain generated colors.</p>
<p>Useful for merging similar datasets, whose labels need to be aligned.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">project_labels <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-l DST_LABELS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>-l</code>, <code>--label</code> (str; repeatable) - Label name (ordered)</li>
</ul>
<p>Examples:
Set dataset labels to [<code>person</code>, <code>cat</code>, <code>dog</code>], remove others, add missing.
Original labels (for example): <code>cat</code>, <code>dog</code>, <code>elephant</code>, <code>human</code>.
New labels: <code>person</code> (added), <code>cat</code> (kept), <code>dog</code> (kept).</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t project_labels -- -l person -l cat -l dog
</code></pre></div><p><a id="shapes_to_boxes-transform"></a></p>
<h5 id="shapes_to_boxes"><code>shapes_to_boxes</code></h5>
<p>Converts spatial annotations (masks, polygons, polylines, points)
to enclosing bounding boxes.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">shapes_to_boxes <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p>Example:
Convert spatial annotations between each other</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum transform -t boxes_to_masks
datum transform -t masks_to_polygons
datum transform -t polygons_to_masks
datum transform -t shapes_to_boxes
</code></pre></div><p><a id="boxes_to_masks-transform"></a></p>
<h5 id="boxes_to_masks"><code>boxes_to_masks</code></h5>
<p>Converts bounding boxes to masks.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">boxes_to_masks <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="polygons_to_masks-transform"></a></p>
<h5 id="polygons_to_masks"><code>polygons_to_masks</code></h5>
<p>Converts polygons to masks.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">polygons_to_masks <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="masks_to_polygons-transform"></a></p>
<h5 id="masks_to_polygons"><code>masks_to_polygons</code></h5>
<p>Converts masks to polygons.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">masks_to_polygons <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="anns_to_labels-transform"></a></p>
<h5 id="anns_to_labels"><code>anns_to_labels</code></h5>
<p>Collects all labels from annotations (of all types) and transforms
them into a set of annotations of type <code>Label</code></p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">anns_to_labels <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="merge_instance_segments-transform"></a></p>
<h5 id="merge_instance_segments"><code>merge_instance_segments</code></h5>
<p>Replaces instance masks and, optionally, polygons with a single mask.
A group of annotations with the same group id is considered an &ldquo;instance&rdquo;.
The largest annotation in the group is considered the group &ldquo;head&rdquo;, so the
resulting mask takes properties from that annotation.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">merge_instance_segments <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--include-polygons<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
<li><code>--include-polygons</code> (flag) - Include polygons</li>
</ul>
<p><a id="crop_covered_segments-transform"></a></p>
<h5 id="crop_covered_segments"><code>crop_covered_segments</code></h5>
<p>Sorts polygons and masks (&ldquo;segments&rdquo;) according to <code>z_order</code>,
crops covered areas of underlying segments. If a segment is split
into several independent parts by the segments above, produces
the corresponding number of separate annotations joined into a group.</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">crop_covered_segments <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>
<p><a id="bbox_value_decrement-transform"></a></p>
<h5 id="bbox_value_decrement"><code>bbox_value_decrement</code></h5>
<p>Subtracts one from the coordinates of bounding boxes</p>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bbox_values_decrement <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Optional arguments:</p>
<ul>
<li><code>-h</code>, <code>--help</code> (flag) - Show this help message and exit</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-10150a1a6326aa9e8f2020442e6da77d">23 - Utilities</h1>
    
	<p><a id="split-video"></a></p>
<h3 id="split-video-into-frames">Split video into frames</h3>
<p>Splits a video into separate frames and saves them in a directory.
After the splitting, the images can be added into a project using
the <a href="../sources/#source-import"><code>import</code> command</a> and the <code>image_dir</code> format.</p>
<p>This command is useful for making a dataset from a video file.
Unlike direct video reading during model training, which can produce
different results if the system environment changes, this command
allows to split the video into frames and use them instead, making
the dataset reproducible and stable.</p>
<p>This command provides different options like setting the frame step
(the <code>-s/--step</code> option), file name pattern (<code>-n/--name-pattern</code>),
starting (<code>-b/--start-frame</code>) and finishing (<code>-e/--end-frame</code>) frame etc.</p>
<p>Note that this command is equivalent to the following commands:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum create -o proj
datum import -p proj -f video_frames video.mp4 -- &lt;params&gt;
datum <span style="color:#204a87">export</span> -p proj -f image_dir -- &lt;params&gt;
</code></pre></div><p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum util split_video <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -i SRC_PATH <span style="color:#ce5c00;font-weight:bold">[</span>-o DST_DIR<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>--overwrite<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>-n NAME_PATTERN<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-s STEP<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-b START_FRAME<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-e END_FRAME<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-x IMAGE_EXT<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>-i, --input-path</code> (string) - Path to the video file</li>
<li><code>-o, --output-dir</code> (string) - Output directory. By default, a subdirectory
in the current directory is used</li>
<li><code>--overwrite</code> - Allows overwriting existing files in the output directory,
when it is not empty</li>
<li><code>-n, --name-pattern</code> (string) - Name pattern for the produced
images (default: <code>%06d</code>)</li>
<li><code>-s, --step</code> (integer) - Frame step (default: 1)</li>
<li><code>-b, --start-frame</code> (integer) - Starting frame (default: 0)</li>
<li><code>-e, --end-frame</code> (integer) - Finishing frame (default: none)</li>
<li><code>-x, --image-ext</code> (string) Output image extension (default: <code>.jpg</code>)</li>
<li><code>-h, --help</code> - Print the help message and exit</li>
</ul>
<p>Example: split a video into frames, use each 30-rd frame:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum util split_video -i video.mp4 -o video.mp4-frames --step <span style="color:#0000cf;font-weight:bold">30</span>
</code></pre></div><p>Example: split a video into frames, save as &lsquo;frame_xxxxxx.png&rsquo; files:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum util split_video -i video.mp4 --image-ext<span style="color:#ce5c00;font-weight:bold">=</span>.png --name-pattern<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;frame_%%06d&#39;</span>
</code></pre></div><p>Example: split a video, add frames and annotations into dataset, export as YOLO:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum util split_video -i video.avi -o video-frames
datum create -o proj
datum import -p proj -f image_dir video-frames
datum import -p proj -f coco_instances annotations.json
datum <span style="color:#204a87">export</span> -p proj -f yolo -- --save-images
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a6fd93528e84d29a5a0d58dbccb92724">24 - Validate Dataset</h1>
    
	<p>This command inspects annotations with respect to the task type
and stores the results in JSON file.</p>
<p>The task types supported are <code>classification</code>, <code>detection</code>, and
<code>segmentation</code> (the <code>-t/--task-type</code> parameter).</p>
<p>The validation result contains</p>
<ul>
<li><code>annotation statistics</code> based on the task type</li>
<li><code>validation reports</code>, such as
<ul>
<li>items not having annotations</li>
<li>items having undefined annotations</li>
<li>imbalanced distribution in class/attributes</li>
<li>too small or large values</li>
</ul>
</li>
<li><code>summary</code></li>
</ul>
<p>Usage:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum validate <span style="color:#ce5c00;font-weight:bold">[</span>-h<span style="color:#ce5c00;font-weight:bold">]</span> -t TASK <span style="color:#ce5c00;font-weight:bold">[</span>-s SUBSET_NAME<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-p PROJECT_DIR<span style="color:#ce5c00;font-weight:bold">]</span>
  <span style="color:#ce5c00;font-weight:bold">[</span>target<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>-- EXTRA_ARGS<span style="color:#ce5c00;font-weight:bold">]</span>
</code></pre></div><p>Parameters:</p>
<ul>
<li><code>&lt;target&gt;</code> (string) - Target
<a href="../../../../docs/user-manual/how_to_use_datumaro/#revpath">dataset revpath</a>.
By default, validates the current project.</li>
<li><code>-t, --task-type</code> (string) - Task type for validation</li>
<li><code>-s, --subset</code> (string) - Dataset subset to be validated</li>
<li><code>-p, --project</code> (string) - Directory of the project to operate on
(default: current directory).</li>
<li><code>-h, --help</code> - Print the help message and exit.</li>
<li><code>&lt;extra args&gt;</code> - The list of extra validation parameters. Should be passed
after the <code>--</code> separator after the main command arguments:
<ul>
<li><code>-fs, --few-samples-thr</code> (number) - The threshold for giving a warning
for minimum number of samples per class</li>
<li><code>-ir, --imbalance-ratio-thr</code> (number) - The threshold for giving
imbalance data warning</li>
<li><code>-m, --far-from-mean-thr</code> (number) - The threshold for giving
a warning that data is far from mean</li>
<li><code>-dr, --dominance-ratio-thr</code> (number) - The threshold for giving
a warning bounding box imbalance</li>
<li><code>-k, --topk-bins</code> (number) - The ratio of bins with the highest
number of data to total bins in the histogram</li>
</ul>
</li>
</ul>
<p>Example : give warning when imbalance ratio of data with classification task
over 40</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">datum validate -p prj/ -t classification -- -ir <span style="color:#0000cf;font-weight:bold">40</span>
</code></pre></div><p>Here is the list of validation items(a.k.a. anomaly types).</p>
<table>
<thead>
<tr>
<th>Anomaly Type</th>
<th>Description</th>
<th>Task Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>MissingLabelCategories</td>
<td>Metadata (ex. LabelCategories) should be defined</td>
<td>common</td>
</tr>
<tr>
<td>MissingAnnotation</td>
<td>No annotation found for an Item</td>
<td>common</td>
</tr>
<tr>
<td>MissingAttribute</td>
<td>An attribute key is missing for an Item</td>
<td>common</td>
</tr>
<tr>
<td>MultiLabelAnnotations</td>
<td>Item needs a single label</td>
<td>classification</td>
</tr>
<tr>
<td>UndefinedLabel</td>
<td>A label not defined in the metadata is found for an item</td>
<td>common</td>
</tr>
<tr>
<td>UndefinedAttribute</td>
<td>An attribute not defined in the metadata is found for an item</td>
<td>common</td>
</tr>
<tr>
<td>LabelDefinedButNotFound</td>
<td>A label is defined, but not found actually</td>
<td>common</td>
</tr>
<tr>
<td>AttributeDefinedButNotFound</td>
<td>An attribute is defined, but not found actually</td>
<td>common</td>
</tr>
<tr>
<td>OnlyOneLabel</td>
<td>The dataset consists of only label</td>
<td>common</td>
</tr>
<tr>
<td>OnlyOneAttributeValue</td>
<td>The dataset consists of only attribute value</td>
<td>common</td>
</tr>
<tr>
<td>FewSamplesInLabel</td>
<td>The number of samples in a label might be too low</td>
<td>common</td>
</tr>
<tr>
<td>FewSamplesInAttribute</td>
<td>The number of samples in an attribute might be too low</td>
<td>common</td>
</tr>
<tr>
<td>ImbalancedLabels</td>
<td>There is an imbalance in the label distribution</td>
<td>common</td>
</tr>
<tr>
<td>ImbalancedAttribute</td>
<td>There is an imbalance in the attribute distribution</td>
<td>common</td>
</tr>
<tr>
<td>ImbalancedDistInLabel</td>
<td>Values (ex. bbox width) are not evenly distributed for a label</td>
<td>detection, segmentation</td>
</tr>
<tr>
<td>ImbalancedDistInAttribute</td>
<td>Values (ex. bbox width) are not evenly distributed for an attribute</td>
<td>detection, segmentation</td>
</tr>
<tr>
<td>NegativeLength</td>
<td>The width or height of bounding box is negative</td>
<td>detection</td>
</tr>
<tr>
<td>InvalidValue</td>
<td>There&rsquo;s invalid (ex. inf, nan) value for bounding box info.</td>
<td>detection</td>
</tr>
<tr>
<td>FarFromLabelMean</td>
<td>An annotation has an too small or large value than average for a label</td>
<td>detection, segmentation</td>
</tr>
<tr>
<td>FarFromAttrMean</td>
<td>An annotation has an too small or large value than average for an attribute</td>
<td>detection, segmentation</td>
</tr>
</tbody>
</table>
<p>Validation Result Format:</p>
<details>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;statistics&#39;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#8f5902;font-style:italic">## common statistics</span>
        <span style="color:#4e9a06">&#39;label_distribution&#39;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#4e9a06">&#39;defined_labels&#39;</span>: &lt;dict&gt;,   <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: &lt;count:int&gt;</span>
            <span style="color:#4e9a06">&#39;undefined_labels&#39;</span>: &lt;dict&gt;
            <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#     &#39;count&#39;: &lt;int&gt;,</span>
            <span style="color:#8f5902;font-style:italic">#     &#39;items_with_undefined_label&#39;: [&lt;item_key&gt;, ]</span>
            <span style="color:#8f5902;font-style:italic"># }</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>,
        <span style="color:#4e9a06">&#39;attribute_distribution&#39;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#4e9a06">&#39;defined_attributes&#39;</span>: &lt;dict&gt;,
            <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#     &lt;attribute:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#         &#39;distribution&#39;: {&lt;attr_value:str&gt;: &lt;count:int&gt;, },</span>
            <span style="color:#8f5902;font-style:italic">#         &#39;items_missing_attribute&#39;: [&lt;item_key&gt;, ]</span>
            <span style="color:#8f5902;font-style:italic">#     }</span>
            <span style="color:#8f5902;font-style:italic"># }</span>
            <span style="color:#4e9a06">&#39;undefined_attributes&#39;</span>: &lt;dict&gt;
            <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#     &lt;attribute:str&gt;: {</span>
            <span style="color:#8f5902;font-style:italic">#         &#39;distribution&#39;: {&lt;attr_value:str&gt;: &lt;count:int&gt;, },</span>
            <span style="color:#8f5902;font-style:italic">#         &#39;items_with_undefined_attr&#39;: [&lt;item_key&gt;, ]</span>
            <span style="color:#8f5902;font-style:italic">#     }</span>
            <span style="color:#8f5902;font-style:italic"># }</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>,
        <span style="color:#4e9a06">&#39;total_ann_count&#39;</span>: &lt;int&gt;,
        <span style="color:#4e9a06">&#39;items_missing_annotation&#39;</span>: &lt;list&gt;, <span style="color:#8f5902;font-style:italic"># [&lt;item_key&gt;, ]</span>

        <span style="color:#8f5902;font-style:italic">## statistics for classification task</span>
        <span style="color:#4e9a06">&#39;items_with_multiple_labels&#39;</span>: &lt;list&gt;, <span style="color:#8f5902;font-style:italic"># [&lt;item_key&gt;, ]</span>

        <span style="color:#8f5902;font-style:italic">## statistics for detection task</span>
        <span style="color:#4e9a06">&#39;items_with_invalid_value&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: {&lt;ann_id:int&gt;: [ &lt;property:str&gt;, ], }</span>
        <span style="color:#8f5902;font-style:italic"># - properties: &#39;x&#39;, &#39;y&#39;, &#39;width&#39;, &#39;height&#39;,</span>
        <span style="color:#8f5902;font-style:italic">#               &#39;area(wxh)&#39;, &#39;ratio(w/h)&#39;, &#39;short&#39;, &#39;long&#39;</span>
        <span style="color:#8f5902;font-style:italic"># - &#39;short&#39; is min(w,h) and &#39;long&#39; is max(w,h).</span>
        <span style="color:#4e9a06">&#39;items_with_negative_length&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: { &lt;ann_id:int&gt;: { &lt;&#39;width&#39;|&#39;height&#39;&gt;: &lt;value&gt;, }, }</span>
        <span style="color:#4e9a06">&#39;bbox_distribution_in_label&#39;</span>: &lt;dict&gt;, <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: &lt;bbox_template&gt;</span>
        <span style="color:#4e9a06">&#39;bbox_distribution_in_attribute&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {&lt;attribute:str&gt;: { &lt;attr_value&gt;: &lt;bbox_template&gt;, }, }</span>
        <span style="color:#4e9a06">&#39;bbox_distribution_in_dataset_item&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: &lt;bbox count:int&gt;</span>

        <span style="color:#8f5902;font-style:italic">## statistics for segmentation task</span>
        <span style="color:#4e9a06">&#39;items_with_invalid_value&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: {&lt;ann_id:int&gt;: [ &lt;property:str&gt;, ], }</span>
        <span style="color:#8f5902;font-style:italic"># - properties: &#39;area&#39;, &#39;width&#39;, &#39;height&#39;</span>
        <span style="color:#4e9a06">&#39;mask_distribution_in_label&#39;</span>: &lt;dict&gt;, <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: &lt;mask_template&gt;</span>
        <span style="color:#4e9a06">&#39;mask_distribution_in_attribute&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &lt;label:str&gt;: {</span>
        <span style="color:#8f5902;font-style:italic">#     &lt;attribute:str&gt;: { &lt;attr_value&gt;: &lt;mask_template&gt;, }</span>
        <span style="color:#8f5902;font-style:italic"># }</span>
        <span style="color:#4e9a06">&#39;mask_distribution_in_dataset_item&#39;</span>: &lt;dict&gt;,
        <span style="color:#8f5902;font-style:italic"># &#39;&lt;item_key&gt;&#39;: &lt;mask/polygon count: int&gt;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>,
    <span style="color:#4e9a06">&#39;validation_reports&#39;</span>: &lt;list&gt;, <span style="color:#8f5902;font-style:italic"># [ &lt;validation_error_format&gt;, ]</span>
    <span style="color:#8f5902;font-style:italic"># validation_error_format = {</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;anomaly_type&#39;: &lt;str&gt;,</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;description&#39;: &lt;str&gt;,</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;severity&#39;: &lt;str&gt;, # &#39;warning&#39; or &#39;error&#39;</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;item_id&#39;: &lt;str&gt;,  # optional, when it is related to a DatasetItem</span>
    <span style="color:#8f5902;font-style:italic">#     &#39;subset&#39;: &lt;str&gt;,   # optional, when it is related to a DatasetItem</span>
    <span style="color:#8f5902;font-style:italic"># }</span>
    <span style="color:#4e9a06">&#39;summary&#39;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#4e9a06">&#39;errors&#39;</span>: &lt;count: int&gt;,
        <span style="color:#4e9a06">&#39;warnings&#39;</span>: &lt;count: int&gt;
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>

</code></pre></div><p><code>item_key</code> is defined as,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">item_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">DatasetItem</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">:</span><span style="color:#204a87">str</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">DatasetItem</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">subset</span><span style="color:#000;font-weight:bold">:</span><span style="color:#204a87">str</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>bbox_template</code> and <code>mask_template</code> are defined as,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">bbox_template</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;width&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;height&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;area(wxh)&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;ratio(w/h)&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;short&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic"># short = min(w, h)</span>
    <span style="color:#4e9a06">&#39;long&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>   <span style="color:#8f5902;font-style:italic"># long = max(w, h)</span>
<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000">mask_template</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;area&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;width&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;height&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">numerical_stat_template</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><code>numerical_stat_template</code> is defined as,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">numerical_stat_template</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#39;items_far_from_mean&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">dict</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#8f5902;font-style:italic"># {&#39;&lt;item_key&gt;&#39;: {&lt;ann_id:int&gt;: &lt;value:float&gt;, }, }</span>
    <span style="color:#4e9a06">&#39;mean&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;stddev&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;min&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;max&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;median&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#4e9a06">&#39;histogram&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#4e9a06">&#39;bins&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">list</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span>   <span style="color:#8f5902;font-style:italic"># [&lt;float&gt;, ]</span>
        <span style="color:#4e9a06">&#39;counts&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87">list</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic"># [&lt;int&gt;, ]</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div></details>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-2 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="" aria-label="">
    <a class="text-white" rel="noopener noreferrer" href="">
      <i class=""></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-2 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" rel="noopener noreferrer" href="https://github.com/openvinotoolkit/datumaro">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-8 text-center order-sm-2">
        <small class="mr-1"><a href="https://www.intel.com/content/www/us/en/privacy/intel-privacy-notice.html">Privacy Policy</a></small>
        |
        <small class="mx-1"><a href="https://www.intel.com/content/www/us/en/legal/terms-of-use.html">Terms of Use</a></small>
        <br/>
        <div class="footer-disclaimer text-white ">
          <small>Intel technologies may require enabled hardware, software or service activation. // No product or component can be absolutely secure. // Your costs and results may vary. // Performance varies by use, configuration and other factors. // See our complete legal <u><a href="https://edc.intel.com/content/www/us/en/products/performance/benchmarks/overview/?r=219444055">Notices and Disclaimers</a></u>. // Intel is committed to respecting human rights and avoiding complicity in human rights abuses. See Intel’s <a href="https://www.intel.com/content/www/us/en/policy/policy-human-rights.html"><u>Global Human Rights Principles</u></a>. Intel’s products and software are intended only to be used in applications that do not cause or contribute to a violation of an internationally recognized human right.</small>
        </div>
        
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js" integrity="sha384-uQikAXnCAqsMb3ygtdqBYvcwvHUkzGIpjdGyy9owhURXHUxLC5LgTcSxJQH/RzjK" crossorigin="anonymous"></script>





 













<script src="../../../../js/main.min.ee00f42d1b949caa55ccf416202998d65afac8f58091e2719c89d4fc3518550e.js" integrity="sha256-7gD0LRuUnKpVzPQWICmY1lr6yPWAkeJxnInU/DUYVQ4=" crossorigin="anonymous"></script>



<script src='../../../../js/prism.js'></script>



  </body>
</html>
